{"version":3,"sources":["components/constructior-item/constructor-item.module.css","components/scrolled-container/scrolled-container.module.css","components/modal-overlay/modal-overlay.module.css","components/price/price.module.css","components/ingredient-card/ingredient-card.module.css","pages/home/home.module.css","components/orders-stats/orders-stats.module.css","components/ingredient-details/ingredient-details.module.css","components/order-info/order-info.module.css","hooks/index.ts","components/protected-route/protected-route.tsx","store/slices/posted-order-details.ts","store/slices/burger-constructor.ts","components/constructior-item/constructor-item.tsx","components/scrolled-container/scrolled-container.tsx","components/modal-overlay/modal-overlay.tsx","components/modal/modal.tsx","components/spinner/spinner.tsx","components/error/error.tsx","components/order-details/order-details.tsx","components/active-bun/active-bun.tsx","components/price/price.tsx","utils/getId.ts","components/burger-constructor/burger-constructor.tsx","hooks/customHoocs.ts","components/ingredient-card/ingredient-card.tsx","components/tabs-list/tabs-list.tsx","components/burger-ingredients/utils.ts","components/burger-ingredients/burger-ingredients.tsx","pages/home/index.tsx","components/form-page-template/form-page-template.tsx","components/note/note.tsx","utils/cookie.ts","store/slices/login.ts","pages/login/index.tsx","store/slices/registration.ts","pages/registration/index.tsx","store/slices/forgot-password.ts","pages/forgot-password/index.tsx","store/slices/reset-password.ts","pages/reset-password/index.tsx","store/slices/profile.ts","components/user-form/user-form.tsx","components/ingredient-preview/ingredient-preview.tsx","utils/getNormalizedDateTimeString.ts","utils/constants.ts","components/order-card/order-card.tsx","components/orders-feed/orders-feed.tsx","store/slices/all-orders-feed.ts","store/ws-actions/ws-all-orders-feed-actions.ts","store/slices/user-orders-feed.ts","store/ws-actions/index.ts","store/ws-actions/ws-user-orders-feed-actions.ts","store/ws-actions/ws-common-actions.ts","components/user-orders-feed/user-orders-feed.tsx","pages/profile/index.tsx","components/ingredient-details/ingredient-details.tsx","pages/ingredient/index.tsx","components/orders-stats/orders-stats.tsx","pages/feed/index.tsx","pages/not-found-404/index.tsx","store/slices/user-order.ts","components/order-info/order-info.tsx","components/app-nav/app-nav.tsx","components/app-header/app-header.tsx","components/layout/layout.tsx","store/slices/burger-ingredients.ts","components/app/app.tsx","services/wsServices.ts","store/middlewares/ordersFeedSocketMiddleware.ts","services/api.ts","store/slices/index.ts","store/index.ts","index.tsx","pages/profile/profile.module.css","components/burger-constructor/burger-constructor.module.css","components/order-card/order-card.module.css","components/spinner/spinner.module.css","components/order-details/order-details.module.css","pages/feed/feed.module.css","components/modal/modal.module.css","components/form-page-template/form-page-template.module.css","components/orders-feed/orders-feed.module.css","components/app-header/app-header.module.css","components/error/error.module.css","components/burger-ingredients/burger-ingredients.module.css","components/active-bun/active-bun.module.css","components/tabs-list/tabs-list.module.css","components/note/note.module.css","components/user-form/user-form.module.css","components/ingredient-preview/ingredient-preview.module.css","pages/ingredient/ingredient-page.module.css","pages/not-found-404/not-found-404.module.css","components/app-nav/app-nav.module.css"],"names":["module","exports","useSelector","selectorHook","useDispatch","dispatchHook","ProtectedRoute","children","rest","isLogin","state","profile","user","render","location","to","pathname","from","postOrder","createAsyncThunk","ingredientsIds","a","extra","getOrderDetails","response","json","postedOrderDetailsSlice","createSlice","name","initialState","orderDetails","loading","error","reducers","extraReducers","builder","addCase","fulfilled","action","payload","pending","rejected","items","bun","burgerConstructorSlice","addItem","push","removeItem","itemIndex","findIndex","item","_id","splice","swapItems","addBun","actions","ConstructorItem","ingredient","idx","dispatch","ref","useRef","useDrag","type","collect","monitor","isDragging","drag","useDrop","accept","hover","current","dragIndex","hoverIndex","drop","removeFromConstructor","useCallback","className","styles","thumbnail","image","text","price","handleClose","ScrolledContainer","maxHeight","onScroll","style","scroll","ModalOverlay","onClick","evt","target","classList","contains","overlay","modalRoot","document","getElementById","Modal","title","onClose","closeModal","preventDefault","useEffect","onDocumentKeyDown","code","window","addEventListener","removeEventListener","createPortal","modal","header","aria-label","Spinner","width","height","viewBox","y","x","xmlns","spinner","star","fill","d","Error","message","OrderDetails","burgerConstructor","useMemo","length","map","isUserLogin","postedOrderDetails","details","id","order","number","status","note","ActiveBun","isLocked","placeholder","Price","getId","Math","random","toString","BurgerConstructor","useState","setState","toggle","useToggle","isModalOpen","toggleModalActive","orderBtnClickHandler","activeBun","constructorId","isOver","canDrop","dropTarget","totalPrice","reduce","acc","ingredients","constructor","droppedZoneClassName","ingredientsData","ingredientInflight","list","constructorFooter","helper","size","section","IngredientCard","useLocation","dragRef","ingredientLocation","card","src","alt","TabsList","tabsData","activeTab","tabListRef","listItems","Object","keys","key","value","active","getAdaptedIngredientsData","refs","ingredientSectionsData","sauce","main","forEach","BurgerIngredients","burgerIngredients","setActiveTab","bunIngredientsRef","sauceIngredientsRef","mainIngredientsRef","refsMap","adaptedIngredientsData","ingredientsSections","values","data-name","quantity","count","onTabClick","scrollIntoView","behavior","setActiveTabOnScroll","find","getBoundingClientRect","top","bottom","HomePage","DndProvider","backend","HTML5Backend","flex","FormPageTemplate","inputs","notes","submitButtonText","onFormSubmit","reqError","wrapper","form","onSubmit","Note","link","href","setCookie","options","expires","Date","toUTCString","updatedCookie","encodeURIComponent","optionKey","optionValue","cookie","getCookie","matches","match","RegExp","replace","decodeURIComponent","undefined","login","userData","success","accessToken","refreshToken","loginSlice","LoginPage","email","password","inputsData","setInputsData","onInputChange","onChange","register","registrationSlice","RegistrationPage","registration","checkEmailForPassReset","forgotPasswordSlice","emailChecked","ForgotPasswordPage","setEmail","onEmailInput","forgotPassword","resetPassword","resetPasswordSlice","ResetPasswordPage","token","logout","_","getUserData","setUserData","isPendingAction","isPending","isRejectedAction","isRejected","isFulfilledAction","isFulfilled","profileSlice","addMatcher","UserForm","profileData","formSubmitHandler","onCancelBtnClick","icon","IngredientPreview","image_mobile","more","DAYS_MAP","getNormalizedDateTimeString","dateTimeISOstring","date","time","Intl","DateTimeFormat","timeZoneName","hour","minute","format","dayDifference","trunc","titles","cases","declOfNum","BASE_URL","ORDERS_URL","PASSWORD_RESET_URL","USER_DATA_URL","ORDER_STATUSES","done","created","cancel","OrderCard","orderData","createdAt","allBurgerIngredients","filter","includes","statusAddClassName","statusText","dateTime","renderPreviews","previews","index","zIndex","OrdersFeed","ordersData","orderLocation","allOrdersFeedSlice","orders","total","totalToday","wsConnected","wsConnectionSuccess","wsConnectionError","wsConnectionClosed","wsGetMessage","allOrdersFeedActions","onOpen","onError","onMessage","userOrdersFeedSlice","wsActions","allOrders","userOrders","common","wsConnectionInit","createAction","wsConnectionClose","UserOrdersFeed","userOrdersFeed","ProfilePage","history","useHistory","onLogoutBtnClick","useRouteMatch","path","url","nav","exact","description","IngredientDetails","useParams","image_large","calories","proteins","fat","carbohydrates","figure","evergy","th","td","IngredientPage","OrdersStats","inWork","table","renderTbodyRows","colSpan","td_large","tbodyRows","arrForCycle","completeItem","inWorkItem","completeItemNext","inWorkItemNext","quarter","FeedPage","allOrdersFeed","groupedByType","groups","column","NotFound404","getOrderById","userOrderSlice","OrderInfo","userOrder","normalizedData","amount","ingredientId","footer","AppNav","AppHeader","memo","container","logo","Layout","fetchIngredients","getIngredienst","data","burgerIngredientsSlice","pastBun","currentBun","App","console","log","isPoP","goBack","split","wsServices","WebSocket","socketMiddleware","store","socket","socketName","next","close","onopen","event","onmessage","parsedData","JSON","parse","onerror","onclose","Api","fetch","String","URL","stringify","this","_instance","instance","rootReducer","burgerIngredientsReducer","burgerConstructorReducer","postedOrderDetailsReducer","forgotPasswordReducer","registrationPageReducer","loginReducer","resetPasswordReducer","profileReducer","allOrdersFeedReducer","userOrdersFeedReducer","userOrderReducer","configureStore","reducer","middleware","getDefaultMiddleware","thunk","extraArgument","concat","ordersFeedSocketMiddleware","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.625a2705.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"constructor-item_item__FV_tI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scroll\":\"scrolled-container_scroll__3emvY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"modal-overlay_overlay__AKixE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"price\":\"price_price__1PqiV text_type_digits-default text\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"ingredient-card_card__1cRZ7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"flex\":\"home_flex__1tGxl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"orders-stats_table__3KNUK\",\"quarter\":\"orders-stats_quarter__2bdYa\",\"th\":\"orders-stats_th__2xiJJ text_type_main-medium\",\"td\":\"orders-stats_td__38S7t text_type_digits-default p-1\",\"done\":\"orders-stats_done__11fr7\",\"td_large\":\"orders-stats_td_large__3C6gm text_type_digits-large\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"details\":\"ingredient-details_details__uP6-A pb-15\",\"figure\":\"ingredient-details_figure__2yX8t mb-8\",\"image\":\"ingredient-details_image__H2-xP mb-4\",\"title\":\"ingredient-details_title__2_5MB text text_type_main-medium\",\"evergy\":\"ingredient-details_evergy__1-w4w\",\"td\":\"ingredient-details_td__1tiuS text_type_digits-default\",\"th\":\"ingredient-details_th__1Vb6- text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"order-info_card__3u0GJ pb-20\",\"header\":\"order-info_header__1sYHj pb-15\",\"id\":\"order-info_id__2I5Sa text_type_digits-default text mb-10\",\"title\":\"order-info_title__LqHMJ text text_type_main-medium mb-3\",\"status\":\"order-info_status__wcc9g text text_type_main-default\",\"structure-title\":\"order-info_structure-title__3HeF8 text text_type_main-medium mb-6\",\"list\":\"order-info_list__3DYZ3 list-reset pr-6\",\"item\":\"order-info_item__AxHy8 mb-4\",\"ingredient\":\"order-info_ingredient__30pRC\",\"ingredient-name\":\"order-info_ingredient-name__2imTi text_type_main-default text ml-4 pr-6\",\"price\":\"order-info_price__sNxEd text text_type_digits-default\",\"footer\":\"order-info_footer__2VeuG pt-10\",\"time-wrapper\":\"order-info_time-wrapper__pysQd text\",\"time\":\"order-info_time__1eO6f text_type_main-default\"};","import {\n  TypedUseSelectorHook,\n  useDispatch as dispatchHook,\n  useSelector as selectorHook\n} from 'react-redux';\n\nimport type { RootState, AppDispatch } from '../types';\n\nexport const useSelector: TypedUseSelectorHook<RootState> = selectorHook;\nexport const useDispatch = () => dispatchHook<AppDispatch>();\n","import React, { ReactNode } from 'react';\nimport { useSelector } from '../../hooks';\nimport { Route, Redirect } from 'react-router-dom';\n\nconst ProtectedRoute = ( { children, ...rest }: { children: ReactNode; path: string} ) => {\n  const isLogin = useSelector( ( state ) => state.profile.user.isLogin );\n\n  return (\n    <Route\n      { ...rest }\n      render={ ( { location } ) =>{\n       return isLogin ? (\n          children\n        ) : (\n          <Redirect to={ {\n            pathname: '/login',\n            state: { from: location }\n          } } />\n        );}\n      }\n    />\n  );\n};\n\nexport default ProtectedRoute;\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\nimport { IAsyncThunkExtraArgument, TPostedOrderDetails } from '../../types';\n\ninterface IPostedOrderDetailsState {\n  orderDetails: null | TPostedOrderDetails;\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: IPostedOrderDetailsState = {\n  orderDetails: null,\n  loading: false,\n  error: null,\n};\n\nconst postOrder = createAsyncThunk<\n  TPostedOrderDetails,\n  Array<string>,\n  IAsyncThunkExtraArgument\n>\n(\n  'postedOrderDetails/postOrder',\n  async ( ingredientsIds, { extra } ) => {\n    const response = await extra.getOrderDetails( ingredientsIds );\n    const json = await response.json();\n    return json;\n  }\n);\n\nconst postedOrderDetailsSlice = createSlice( {\n  name: 'postedOrderDetails',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( postOrder.fulfilled, ( state, action ) => {\n        state.loading = false;\n        state.orderDetails = action.payload;\n      } )\n      .addCase( postOrder.pending, ( state ) => {\n        state.loading = true;\n        state.error = null;\n      } )\n      .addCase( postOrder.rejected, ( state, action ) => {\n        state.loading = false;\n        state.error = action.error;\n        state.orderDetails = null;\n      } );\n  },\n} );\n\nexport { postOrder };\nexport default postedOrderDetailsSlice.reducer;\n","import { createSlice } from '@reduxjs/toolkit';\n\nimport { postOrder } from './posted-order-details';\nimport { TBurgerConstructorIgredient } from '../../types';\n\ninterface IBurgerConstructorState {\n  items: Array<TBurgerConstructorIgredient>;\n  bun: TBurgerConstructorIgredient | null;\n}\n\nexport const initialState: IBurgerConstructorState = {\n  items: [],\n  bun: null\n};\n\nconst burgerConstructorSlice = createSlice( {\n  name: 'burgerConstructor',\n  initialState,\n  reducers: {\n    addItem: ( state, { payload } ) => {\n      state.items.push( payload );\n    },\n    removeItem: ( state, { payload } ) => {\n      const itemIndex = state.items.findIndex( ( item ) => item._id === payload );\n      state.items.splice( itemIndex, 1 );\n    },\n    swapItems: ( { items }, { payload: { from, to } } ) => {\n      [items[from], items[to]] = [items[to], items[from]];\n    },\n    addBun: ( state, { payload: { bun } } ) => {\n      if (\n        ( state.bun === null ) ||\n        ( state.bun && state.bun._id !== bun._id )\n      ) {\n        state.bun = bun;\n      }\n    },\n  },\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( postOrder.fulfilled, () => initialState );\n    }\n} );\n\nexport default burgerConstructorSlice.reducer;\nexport const { addItem, removeItem, addBun, swapItems } = burgerConstructorSlice.actions;\n","import React, { useCallback, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { removeItem, swapItems } from '../../store/slices/burger-constructor';\n\nimport { useDrop, useDrag } from 'react-dnd';\n\nimport { ConstructorElement, DragIcon } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport styles from './constructor-item.module.css';\n\nimport { TIngredient } from '../../types';\n\ninterface IConstructorItem {\n  ingredient: TIngredient,\n  idx: number\n}\n\nconst ConstructorItem = ( { ingredient, idx }: IConstructorItem ) => {\n  const dispatch = useDispatch();\n  const ref = useRef( null );\n\n  const [, drag] = useDrag( {\n    type: 'constructorItem',\n    item: { idx },\n    collect: ( monitor ) => ( {\n      isDragging: monitor.isDragging(),\n    } ),\n  } );\n\n  const [, drop] = useDrop( {\n    accept: 'constructorItem',\n    hover: ( item: { idx: number } ) => {\n      if ( !ref.current ) {\n        return;\n      }\n\n      const dragIndex = item.idx;\n      const hoverIndex = idx;\n\n      if ( dragIndex === hoverIndex ) {\n        return;\n      }\n\n      dispatch( swapItems( { from: dragIndex, to: hoverIndex } ) );\n\n      item.idx = hoverIndex;\n    },\n  } );\n\n  const removeFromConstructor = useCallback( () => {\n    dispatch( removeItem( ingredient._id ) );\n  }, [ingredient._id, dispatch] );\n\n  drag( drop( ref ) );\n\n  return (\n    <div\n      className={ styles.item }\n      ref={ ref }\n    >\n      <DragIcon type='primary' />\n      <ConstructorElement\n        thumbnail={ ingredient.image }\n        text={ ingredient.name }\n        price={ ingredient.price }\n        handleClose={ removeFromConstructor }\n      />\n    </div>\n  );\n};\n\nexport default ConstructorItem;\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport styles from './scrolled-container.module.css';\r\nimport { ReactNode } from 'react';\r\n\r\ninterface IScrolledContainer {\r\n  maxHeight: string,\r\n  children: ReactNode,\r\n  onScroll?: () => void;\r\n}\r\n\r\nconst ScrolledContainer = ( { maxHeight, children, onScroll }: IScrolledContainer ) => (\r\n  <div\r\n    style={ { maxHeight } }\r\n    className={ styles.scroll }\r\n    onScroll={ onScroll }\r\n  >\r\n    { children }\r\n  </div>\r\n);\r\n\r\nexport default ScrolledContainer;\r\n\r\nScrolledContainer.propTypes = {\r\n  maxHeight: PropTypes.string,\r\n  children: PropTypes.oneOfType(\r\n    [ PropTypes.element, PropTypes.array ]\r\n  ).isRequired,\r\n  onScroll: PropTypes.func\r\n};\r\n","import React, { MouseEvent } from 'react';\r\n\r\nimport styles from './modal-overlay.module.css';\r\nimport { ReactNode } from 'react';\r\n\r\ninterface IModalOverlay {\r\n  children: ReactNode;\r\n  onClick: ( evt: MouseEvent<HTMLDivElement> ) => void;\r\n}\r\n\r\nconst ModalOverlay = ( { children, onClick }: IModalOverlay ) => {\r\n  const onOverlayClick = ( evt: MouseEvent<HTMLDivElement> ) => {\r\n    const target = evt.target as HTMLDivElement;\r\n\r\n    if ( target.classList.contains( 'js-overlay' ) ) {\r\n      onClick( evt );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div onClick={ onOverlayClick } className={ `${ styles.overlay } js-overlay` }>\r\n      { children }\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ModalOverlay;\r\n","import React, { useEffect, useCallback, ReactNode } from 'react';\r\nimport { createPortal } from 'react-dom';\r\n\r\nimport { CloseIcon } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport ModalOverlay from '../modal-overlay/modal-overlay';\r\n\r\nimport styles from './modal.module.css';\r\n\r\nconst modalRoot = document.getElementById( 'modal' ) as HTMLDivElement;\r\n\r\ninterface IModal {\r\n  children: ReactNode,\r\n  title?: string,\r\n  onClose: () => void\r\n}\r\n\r\nconst Modal = ( { children, title, onClose }: IModal ) => {\r\n  const closeModal = useCallback( ( evt ) => {\r\n    evt.preventDefault();\r\n\r\n    onClose();\r\n  }, [ onClose ] );\r\n\r\n  useEffect( () => {\r\n    const onDocumentKeyDown = ( evt: {code: string} ) => {\r\n      if ( evt.code === 'Escape' ) {\r\n        closeModal( evt );\r\n      }\r\n    };\r\n\r\n    window.addEventListener( 'keydown', onDocumentKeyDown );\r\n    return () => {\r\n      window.removeEventListener( 'keydown', onDocumentKeyDown );\r\n    };\r\n  }, [closeModal] );\r\n\r\n  return ( createPortal(\r\n    <ModalOverlay onClick={ closeModal }>\r\n      <div className={ styles.modal }>\r\n        <header className={ styles.header }>\r\n          <h2 className={ styles.title }>{ title }</h2>\r\n          <button onClick={ closeModal } className={ styles['close-btn'] } aria-label='Закрыть модальое окно' type='button'>\r\n            <CloseIcon type='primary' />\r\n          </button>\r\n        </header>\r\n        { children }\r\n      </div>\r\n    </ModalOverlay>,\r\n    modalRoot ) );\r\n};\r\n\r\nexport default Modal;\r\n","import React from 'react';\r\n\r\nimport styles from './spinner.module.css';\r\n\r\nconst Spinner = ( { width = '232', height = '232' } ) => {\r\n  return (\r\n    <svg\r\n      viewBox='0 0 100 100'\r\n      y='0'\r\n      x='0'\r\n      xmlns='http://www.w3.org/2000/svg'\r\n      width={ width }\r\n      height={ height }\r\n      className={ styles.spinner }>\r\n      <g>\r\n        <g className={ styles.star }>\r\n          <path\r\n            fill='#f5e169' d='M57.7 35.7l-8.3-.6c-6.5-.5-11.6-5.6-12-12.1l-.6-9.6c0-.6-.5-1.1-1.1-1.1h-.3c-.6 0-1.1.5-1.1 1.1l-.6 9.6c-.4 6.5-5.5 11.6-12 12.1l-8.3.6c-.5 0-1 .4-1.1.9-.1.7.4 1.3 1 1.3l8.4.6c6.5.5 11.6 5.6 12 12.1l.6 9.6c0 .6.5 1.1 1.1 1.1h.3c.6 0 1.1-.5 1.1-1.1l.6-9.6c.4-6.5 5.5-11.6 12-12.1l8.4-.6c.7 0 1.1-.6 1-1.3-.1-.5-.6-.9-1.1-.9z'\r\n          >\r\n          </path>\r\n        </g>\r\n\r\n        <g className={ styles.star }>\r\n          <path fill='#f5e169' d='M65.2 74.9l-4.2-.3c-3.2-.2-5.8-2.8-6-6l-.3-4.8c0-.3-.3-.5-.6-.5H54c-.3 0-.5.2-.6.5l-.3 4.8c-.2 3.2-2.8 5.8-6 6l-4.2.3c-.3 0-.5.2-.5.5.1.3.3.6.6.6l4.2.3c3.2.2 5.8 2.8 6 6l.3 4.8c0 .3.3.5.6.5h.1c.3 0 .5-.2.6-.5l.3-4.8c.2-3.2 2.8-5.8 6-6l4.2-.3c.3 0 .6-.3.5-.7-.1-.2-.3-.4-.6-.4z'></path>\r\n        </g>\r\n\r\n        <g className={ styles.star }>\r\n          <path fill='#f5e169' d='M91.6 50.3l-6.5-.5c-5-.4-8.9-4.5-9.3-9.6l-.5-7.7c0-.5-.4-.8-.9-.8h-.2c-.5 0-.8.4-.9.8l-.5 7.7c-.3 5.1-4.3 9.3-9.3 9.6l-6.5.5c-.4 0-.8.3-.8.7-.1.5.3 1 .8 1.1l6.5.5c5 .4 8.9 4.5 9.3 9.6l.5 7.7c0 .5.4.8.9.8h.2c.5 0 .8-.4.9-.8l.5-7.7c.3-5.1 4.3-9.3 9.3-9.6l6.5-.5c.5 0 .9-.5.8-1.1 0-.3-.3-.6-.8-.7z'>\r\n          </path>\r\n        </g>\r\n\r\n        <g className={ styles.star }>\r\n          <path fill='#f5e169' d='M28.2 70.2l-3.8-.3c-2.9-.2-5.3-2.6-5.5-5.5l-.3-4.4c0-.3-.2-.5-.5-.5H18c-.3 0-.5.2-.5.5l-.3 4.4c-.2 2.9-2.5 5.3-5.5 5.5l-3.7.3c-.2 0-.5.2-.5.4 0 .4.2.6.5.6l3.8.3c2.9.2 5.3 2.6 5.5 5.5l.3 4.4c0 .3.2.5.5.5h.1c.3 0 .5-.2.5-.5L19 77c.2-2.9 2.5-5.3 5.5-5.5l3.8-.3c.3 0 .5-.3.5-.6-.2-.2-.4-.4-.6-.4z'></path>\r\n        </g>\r\n      </g>\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default Spinner;\r\n","import React from 'react';\r\nimport { SerializedError } from '@reduxjs/toolkit';\r\nimport styles from './error.module.css';\r\n\r\ninterface IError {\r\n  width?: string;\r\n  height?: string;\r\n  error: SerializedError | null\r\n};\r\n\r\nconst Error = ( { width = '232', height = '232', error }: IError ) => {\r\n  return (\r\n    <div className={ styles.error }>\r\n      <svg width={ width } height={ height } viewBox='0 0 512 512'>\r\n        <path d='m152.4 132.247c-11.926 11.927-19.164 27.192-20.379 42.984-1.25 16.256 3.978 31.125 14.722 41.87 9.7 9.7 22.76 14.9 37.17 14.9q2.327 0 4.7-.182c15.793-1.215 31.058-8.452 42.985-20.379s19.164-27.192 20.379-42.984c1.25-16.256-3.978-31.125-14.722-41.869-21.834-21.832-59.899-19.293-84.855 5.66zm83.621 34.984c-.921 11.988-6.511 23.67-15.739 32.9-9.227 9.227-20.911 14.817-32.9 15.739-11.523.883-21.939-2.695-29.327-10.083s-10.969-17.8-10.082-29.327c.921-11.987 6.511-23.67 15.739-32.9 10.472-10.473 23.821-15.879 36.284-15.879 9.81 0 19.072 3.352 25.941 10.221 7.393 7.39 10.973 17.806 10.086 29.329z' />\r\n        <path d='m184 163.846h16v16h-16z' />\r\n        <path d='m488.944 198.075a8 8 0 0 0 -7.765-6.075h-42.241l-2.285-16h27.347v-16h-29.633l-2.448-17.132a7.99 7.99 0 0 0 -3.482-5.524l-14.015-9.344h25.578v-16h-49.578l-9.985-6.656a8 8 0 0 0 -4.437-1.344h-32v-16h40v-16h-40v-33.835a8 8 0 0 0 -5.242-7.51 240.523 240.523 0 0 0 -290.704 105.345h-.054v.093a236.951 236.951 0 0 0 -23.416 55.907h-.584v2.221a241.358 241.358 0 0 0 -8 61.779 238.58 238.58 0 0 0 32 119.907v.093h.054a241.36 241.36 0 0 0 38.24 49.7 240.09 240.09 0 0 0 285.574 40.506 8 8 0 0 0 4.132-7v-19.206h24v-16h-24v-16h72v-16h-60.687l16-16h36.687a8 8 0 0 0 8-8v-16h32v-16h-32v-17.351l36.479-6.784a8 8 0 0 0 6.365-6.218 241.434 241.434 0 0 0 -1.9-107.572zm-352.944 105.925v16h176v40h-254.5a221.144 221.144 0 0 1 -16.26-40h46.76v-16h-50.862a225.353 225.353 0 0 1 -4.982-40h159.844v40zm340.222-6.874-37.685 7.009a8 8 0 0 0 -6.537 7.865v48h-32a8 8 0 0 0 -5.657 2.343l-32 32a8 8 0 0 0 -2.343 5.657v54.431a224.175 224.175 0 0 1 -242.6-22.431h42.6v-16h-60.744c-.548-.538-1.1-1.065-1.648-1.608a225.909 225.909 0 0 1 -30.841-38.392h181.233v40h-40v16h136v-16h-80v-40h96v-16h-32v-40h88v-16h-208v-40h224v-16h-72v-40h48v-16h-144v16h80v40h-311.844a225.353 225.353 0 0 1 4.982-40h82.862v-16h-78.76a221.144 221.144 0 0 1 16.26-40h62.5v-16h-53.233a225.909 225.909 0 0 1 30.841-38.392c.544-.543 1.1-1.07 1.648-1.608h52.744v-16h-34.6a224.437 224.437 0 0 1 210.6-36.178v68.178a8 8 0 0 0 8 8h37.578l43.008 28.672 7.5 52.46a8 8 0 0 0 7.914 6.868h42.83a225.557 225.557 0 0 1 1.392 89.126z' />\r\n        <path d='m272 136h104v16h-104z' />\r\n        <path d='m168 80h16v16h-16z' />\r\n        <path d='m200 80h112v16h-112z' />\r\n        <path d='m176 416h16v16h-16z' />\r\n        <path d='m104 304h16v16h-16z' />\r\n        <path d='m448 248h16v16h-16z' />\r\n        <path d='m360 40h16v16h-16z' />\r\n        <path d='m456 128h16v16h-16z' />\r\n        <path d='m416 424h16v16h-16z' />\r\n      </svg>\r\n      <p className={ styles.text }>При загрузке данных произошла ошибка</p>\r\n      { error && <p className={ styles.text }>{ error.message }</p> }\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Error;\r\n","import React, { useEffect, useMemo } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\n\r\nimport { useSelector, useDispatch } from '../../hooks';\r\nimport { postOrder } from '../../store/slices/posted-order-details';\r\n\r\nimport Spinner from '../spinner/spinner';\r\nimport Error from '../error/error';\r\n\r\nimport styles from './order-details.module.css';\r\n\r\nconst OrderDetails = () => {\r\n  const { bun, items } = useSelector( ( state ) => state.burgerConstructor );\r\n  const dispatch = useDispatch();\r\n\r\n  const ingredientsIds = useMemo( () => {\r\n    if ( !bun || !items.length ) {\r\n      return [];\r\n    }\r\n\r\n    return [...items.map( ( ingredient ) => ingredient._id ), bun._id];\r\n  }, [bun, items] );\r\n\r\n  const isUserLogin = useSelector( ( state ) => state.profile.user.isLogin );\r\n\r\n  const {\r\n    orderDetails,\r\n    loading,\r\n    error\r\n  } = useSelector( ( state ) => state.postedOrderDetails );\r\n\r\n  useEffect( () => {\r\n    if( isUserLogin ){\r\n      dispatch( postOrder( ingredientsIds ) );\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [] );\r\n\r\n  if ( !isUserLogin ) {\r\n    return <Redirect to='/login'/>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      { loading && ( <Spinner /> ) }\r\n      { error && ( <Error error={ error } /> ) }\r\n      {\r\n        orderDetails && !loading ? (\r\n          <div className={ styles.details }>\r\n            <p className={ styles.id }>{ orderDetails.order.number }</p>\r\n            <h3 className={ styles.title }>идентификатор заказа</h3>\r\n            <p className={ styles.status }>Ваш заказ начали готовить</p>\r\n            <p className={ styles.note }>Дождитесь готовности на орбитальной станции</p>\r\n          </div>\r\n        ) : null\r\n      }\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OrderDetails;\r\n","import React from 'react';\r\nimport { useSelector } from '../../hooks';\r\n\r\nimport { ConstructorElement } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './active-bun.module.css';\r\n\r\nconst ActiveBun = ( { children }: { children: React.ReactNode } ) => {\r\n  const { bun } = useSelector( ( state ) => state.burgerConstructor );\r\n\r\n  if ( !bun ) {\r\n    return (\r\n      <div className={ styles.placeholder }>\r\n        <p className={ styles.text }>Булка не выбрана(( <br /> Тащи её сюда!</p>\r\n        { children }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <ConstructorElement\r\n        price={ bun.price }\r\n        thumbnail={ bun.image }\r\n        text={ `${ bun.name } (верх)` }\r\n        type='top'\r\n        isLocked={ true }\r\n      />\r\n      { children }\r\n      <ConstructorElement\r\n        price={ bun.price }\r\n        thumbnail={ bun.image }\r\n        text={ `${ bun.name } (низ)` }\r\n        type='bottom'\r\n        isLocked={ true }\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ActiveBun;\r\n","import React, { ReactNode } from 'react';\n\nimport { CurrencyIcon } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport styles from './price.module.css';\n\nconst Price = ( { children }: { children: ReactNode; } ) => (\n  <p className={ styles.price }>{ children }<CurrencyIcon type='primary' /></p>\n);\n\nexport default Price;\n","const getId = () => `${ ( ~~( Math.random() * 1e8 ) ).toString( 16 ) }`;\nexport default getId;\n","import React, { useMemo, useCallback } from 'react';\r\nimport { useSelector, useDispatch } from '../../hooks';\r\nimport { addItem, addBun } from '../../store/slices/burger-constructor';\r\n\r\nimport { useDrop } from 'react-dnd';\r\n\r\nimport { Button } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport ConstructorItem from '../constructior-item/constructor-item';\r\nimport ScrolledContainer from '../scrolled-container/scrolled-container';\r\nimport Modal from '../modal/modal';\r\nimport OrderDetails from '../order-details/order-details';\r\nimport ActiveBun from '../active-bun/active-bun';\r\nimport Price from '../price/price';\r\n\r\nimport { useToggle } from '../../hooks/customHoocs';\r\nimport getId from '../../utils/getId';\r\n\r\nimport styles from './burger-constructor.module.css';\r\n\r\nimport { TBurgerConstructorIgredient } from '../../types';\r\n\r\nconst BurgerConstructor = () => {\r\n  const dispatch = useDispatch();\r\n  const { bun, items } = useSelector( ( state ) => state.burgerConstructor );\r\n  const [isModalOpen, toggleModalActive] = useToggle();\r\n\r\n  const orderBtnClickHandler = useCallback( () => {\r\n    if( typeof toggleModalActive === 'function' ){\r\n      toggleModalActive();\r\n    }\r\n  }, [toggleModalActive] );\r\n\r\n  const closeModal = useCallback( () => {\r\n    if( typeof toggleModalActive === 'function' ){\r\n      toggleModalActive();\r\n    }\r\n  }, [toggleModalActive] );\r\n\r\n  const [{ isOver, canDrop }, dropTarget] = useDrop( {\r\n    accept: 'ingredients',\r\n    drop ( item: TBurgerConstructorIgredient ) {\r\n      if ( item.type === 'bun' ) {\r\n        dispatch( addBun( { bun: item, activeBun: bun } ) );\r\n      } else {\r\n        dispatch( addItem( { ...item, constructorId: getId() } ) );\r\n      }\r\n    },\r\n    collect: ( monitor ) => ( {\r\n      isOver: monitor.isOver(),\r\n      canDrop: monitor.canDrop(),\r\n    } ),\r\n  } );\r\n\r\n  const totalPrice = useMemo( () => {\r\n    if ( !bun || !items.length ) {\r\n      return 0;\r\n    }\r\n\r\n    return bun.price + items\r\n      .reduce( ( acc, ingredient ) => acc + ingredient.price, 0 );\r\n  }, [bun, items] );\r\n\r\n  const ingredients = useMemo( () => {\r\n    if ( !items.length ) {\r\n      return (\r\n        <li\r\n          className={ styles.placeholder }\r\n        >\r\n          <p className={ styles['placeholder-text'] }>Тут пусто(( <br /> Тащи сюда  ингредиенты!</p>\r\n        </li>\r\n      );\r\n    }\r\n\r\n    return items.map( ( item, idx ) => {\r\n      return (\r\n        <li key={ item.constructorId } className={ styles.item } >\r\n          <ConstructorItem ingredient={ item } idx={ idx } />\r\n        </li>\r\n      );\r\n    } );\r\n  }, [items] );\r\n\r\n  const constructor = useMemo( () => {\r\n    let droppedZoneClassName = `${ styles.ingredientsData }`;\r\n\r\n    const ingredientInflight = isOver && canDrop;\r\n    if ( ingredientInflight ) {\r\n      droppedZoneClassName =\r\n        `${ styles.ingredientsData } ${ styles.ingredientInflight }`;\r\n    }\r\n    else if ( canDrop ) {\r\n      droppedZoneClassName =\r\n        `${ styles.ingredientsData } ${ styles.canDrop }`;\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <div ref={ dropTarget } className={ droppedZoneClassName }>\r\n          <ActiveBun >\r\n            <ScrolledContainer maxHeight='455px'>\r\n              <ul className={ styles.list }>\r\n                { ingredients }\r\n              </ul>\r\n            </ScrolledContainer>\r\n          </ActiveBun>\r\n        </div>\r\n      </>\r\n    );\r\n  }, [ ingredients, dropTarget, isOver, canDrop ] );\r\n\r\n  const constructorFooter = useMemo( () => {\r\n    if ( bun && !!items.length ) {\r\n      return (\r\n        <div className={ styles.helper }>\r\n          <Price>{ totalPrice }</Price>\r\n\r\n          <Button type='primary' size='large' onClick={ orderBtnClickHandler }>\r\n            Оформить заказ\r\n          </Button>\r\n        </div>\r\n      );\r\n    }\r\n  }, [bun, items, totalPrice, orderBtnClickHandler] );\r\n\r\n  return (\r\n    <>\r\n      {\r\n        isModalOpen &&\r\n        (\r\n          <Modal onClose={ closeModal } >\r\n            <OrderDetails />\r\n          </Modal>\r\n        )\r\n      }\r\n      <section className={ styles.section }>\r\n        <h2 className='visually-hidden'>Конструктор бургера</h2>\r\n        { constructor }\r\n        { constructorFooter }\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BurgerConstructor;\r\n","import { useState, useCallback } from 'react';\r\n\r\nexport const useToggle = ( initialState = false ) => {\r\n  const [state, setState] = useState( initialState );\r\n  const toggle = useCallback( () => setState( ( state ) => !state ), [] );\r\n\r\n  return [state, toggle];\r\n};\r\n","import React from 'react';\r\nimport { Link, useLocation } from 'react-router-dom';\r\n\r\nimport Price from '../price/price';\r\n\r\nimport styles from './ingredient-card.module.css';\r\nimport { useDrag } from 'react-dnd';\r\n\r\nimport { TIngredient } from '../../types';\r\n\r\nconst IngredientCard = ( { ingredient }: {ingredient: TIngredient} ) => {\r\n  const location = useLocation();\r\n\r\n  const { name, price, image, _id } = ingredient;\r\n  const [, dragRef] = useDrag( {\r\n    type: 'ingredients',\r\n    item: ingredient\r\n  } );\r\n\r\n  return (\r\n    <Link to={ {\r\n      pathname: `/ingredients/${ _id }`,\r\n      state: { from: location.pathname, ingredientLocation: location }\r\n    } }>\r\n      <article ref={ dragRef } className={ styles.card }>\r\n        <picture className='mb-2'>\r\n          <img src={ image } alt={ name } />\r\n        </picture>\r\n        <Price>{ price }</Price>\r\n        <h4 className='text_type_main-default text mt-1'>{ name }</h4>\r\n      </article>\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport default IngredientCard;\r\n","import React, { Ref, useMemo } from 'react';\r\n\r\nimport { Tab } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './tabs-list.module.css';\r\nimport { IAdaptedIngredientsData } from '../burger-ingredients/utils';\r\n\r\ninterface ITabsList {\r\n  tabsData: IAdaptedIngredientsData,\r\n  activeTab: string,\r\n  onClick: ( value:string ) => void,\r\n  tabListRef: Ref<HTMLUListElement>\r\n}\r\n\r\nconst TabsList = ( { tabsData, activeTab, onClick, tabListRef }: ITabsList ) => {\r\n  const listItems = useMemo( () => ( Object.keys( tabsData )\r\n    .map( ( key, idx ) => (\r\n      <li key={ idx } className={ styles.item }>\r\n        <Tab\r\n          value={ key }\r\n          active={ key === activeTab }\r\n          onClick={ onClick }\r\n        >{ tabsData[ key ].title }</Tab>\r\n      </li>\r\n    ) ) ), [tabsData, activeTab, onClick] );\r\n\r\n  return <ul ref={ tabListRef } className={ styles.list }>{ listItems }</ul>;\r\n};\r\n\r\nexport default TabsList;\r\n","import { RefObject } from 'react';\r\nimport { TIngredient } from '../../types';\r\n\r\ninterface IRefsObj {\r\n  [i: string]: RefObject<HTMLElement>,\r\n}\r\n\r\ninterface IAdaptedIngredientsDataItem {\r\n  title:  string,\r\n  ref: RefObject<HTMLElement>,\r\n  items: TIngredient[],\r\n  name: string\r\n}\r\n\r\nexport interface IAdaptedIngredientsData {\r\n  [i: string]: IAdaptedIngredientsDataItem\r\n}\r\n\r\nconst getAdaptedIngredientsData = ( ingredientsData: TIngredient[], refs: IRefsObj ) => {\r\n  const ingredientSectionsData: IAdaptedIngredientsData = {\r\n    bun: {\r\n      title: 'Булки',\r\n      ref: refs['bun'],\r\n      items: [],\r\n      name: 'bun'\r\n    },\r\n    sauce: {\r\n      title: 'Соусы',\r\n      ref: refs['sauce'],\r\n      items: [],\r\n      name: 'sauce'\r\n    },\r\n    main: {\r\n      title: 'Начинки',\r\n      ref: refs['main'],\r\n      items: [],\r\n      name: 'main'\r\n    }\r\n  };\r\n\r\n  ingredientsData.forEach( ( ingredient ) => {\r\n    ingredientSectionsData[ingredient.type].items\r\n      .push( ingredient );\r\n  } );\r\n\r\n  return ingredientSectionsData;\r\n};\r\n\r\nexport default getAdaptedIngredientsData;\r\n","import React, { useState, useMemo, useRef, useCallback } from 'react';\r\nimport { useSelector } from '../../hooks';\r\n\r\nimport { Counter } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport IngredientCard from '../ingredient-card/ingredient-card';\r\nimport TabsList from '../tabs-list/tabs-list';\r\nimport ScrolledContainer from '../scrolled-container/scrolled-container';\r\n\r\nimport styles from './burger-ingredients.module.css';\r\n\r\nimport getAdaptedIngredientsData from './utils';\r\n\r\nfunction BurgerIngredients () {\r\n  const ingredientsData = useSelector( state => state.burgerIngredients.items );\r\n  const [ activeTab, setActiveTab ] = useState( 'bun' );\r\n\r\n  const bunIngredientsRef = useRef<HTMLElement>( null );\r\n  const sauceIngredientsRef = useRef<HTMLElement>( null );\r\n  const mainIngredientsRef = useRef<HTMLElement>( null );\r\n\r\n  const tabListRef = useRef<HTMLUListElement>( null );\r\n\r\n  const refsMap = useMemo( () => ( {\r\n    bun: bunIngredientsRef,\r\n    sauce: sauceIngredientsRef,\r\n    main: mainIngredientsRef,\r\n  } ), [bunIngredientsRef, sauceIngredientsRef, mainIngredientsRef] );\r\n\r\n  const adaptedIngredientsData = useMemo(\r\n    () => getAdaptedIngredientsData( ingredientsData, refsMap ),\r\n    [ingredientsData, refsMap]\r\n  );\r\n\r\n  const ingredientsSections = useMemo( () => {\r\n    return Object.values( adaptedIngredientsData )\r\n      .map( ( { name, title, items, ref } ) => {\r\n        return (\r\n          <section data-name={ name } ref={ ref } key={ title } className='pt-10'>\r\n            <h3 className='text text_type_main-medium mb-6'>{ title }</h3>\r\n\r\n            <ul className={ styles.list }>\r\n              { items.map( ( ingredient, idx ) => (\r\n                <li className={ styles.item } key={ idx }>\r\n                  {\r\n                    !!ingredient.quantity &&\r\n                    <Counter count={ ingredient.quantity } size='default' />\r\n                  }\r\n                  <IngredientCard ingredient={ ingredient } />\r\n                </li>\r\n              ) ) }\r\n            </ul>\r\n          </section>\r\n        );\r\n      } );\r\n  }, [adaptedIngredientsData] );\r\n\r\n  const onTabClick = useCallback(\r\n    ( value:string  ) => {\r\n      setActiveTab( value );\r\n\r\n      adaptedIngredientsData[value]\r\n        .ref.current?.scrollIntoView( {\r\n          behavior: 'smooth'\r\n        } );\r\n    },\r\n    [adaptedIngredientsData, setActiveTab],\r\n  );\r\n\r\n  const setActiveTabOnScroll = useCallback(\r\n    () => {\r\n      const name = Object.values( adaptedIngredientsData )\r\n        .find( ( { ref } ) => {\r\n          return (\r\n            ref.current!.getBoundingClientRect().top -\r\n            tabListRef.current!.getBoundingClientRect().bottom +\r\n            ( ref.current!.getBoundingClientRect().height / 1.3 ) ) > 0;\r\n        } )!.name;\r\n      setActiveTab( name );\r\n    },\r\n    [adaptedIngredientsData],\r\n  );\r\n\r\n  return (\r\n    <section className={ styles.section }>\r\n      <h2 className='visually-hidden'>Ингредиенты</h2>\r\n\r\n      <TabsList tabListRef={ tabListRef } tabsData={ adaptedIngredientsData } activeTab={ activeTab } onClick={ onTabClick } />\r\n\r\n      <ScrolledContainer maxHeight={ '716px' } onScroll={ setActiveTabOnScroll }>\r\n        { ingredientsSections }\r\n      </ScrolledContainer>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default BurgerIngredients;\r\n","import React from 'react';\r\n\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\n\r\nimport BurgerConstructor from '../../components/burger-constructor/burger-constructor';\r\nimport BurgerIngredients from '../../components/burger-ingredients/burger-ingredients';\r\n\r\nimport styles from './home.module.css';\r\n\r\nconst HomePage = () => (\r\n  <>\r\n    <h1 className='visually-hidden'>Бургерная 'Stellar burgers'</h1>\r\n    <p className='text text_type_main-large mb-5'>Соберите бургер</p>\r\n    <DndProvider backend={ HTML5Backend }>\r\n      <div className={ styles.flex }>\r\n        <BurgerIngredients />\r\n        <BurgerConstructor />\r\n      </div>\r\n    </DndProvider>\r\n  </>\r\n);\r\n\r\nexport default HomePage;\r\n","import React, { FormEventHandler, ReactNode } from 'react';\n\nimport { Button } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport styles from './form-page-template.module.css';\n\nimport { SerializedError } from '@reduxjs/toolkit';\n\ninterface IFormPageTemplate {\n  inputs: Array<ReactNode>,\n  notes: Array<ReactNode>,\n  title: string,\n  submitButtonText: string,\n  onFormSubmit: FormEventHandler<HTMLFormElement>,\n  reqError: SerializedError | null\n}\n\nconst FormPageTemplate = ( {\n  inputs,\n  notes,\n  title,\n  submitButtonText,\n  onFormSubmit,\n  reqError\n}: IFormPageTemplate ) => {\n  return (\n    <div className={ styles.wrapper }>\n      <h1 className={ styles.title }>{ title }</h1>\n\n      {\n        reqError &&\n        <p className={ styles.error }>{ `${ reqError.message }` }</p>\n      }\n\n      <form className={ styles.form } onSubmit={ onFormSubmit }>\n        { inputs }\n        <Button size='medium' type='primary'>{ submitButtonText }</Button>\n      </form>\n      { notes }\n    </div>\n  );\n};\n\nexport default FormPageTemplate;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport styles from './note.module.css';\nimport { ReactNode } from 'react';\n\ninterface INote {\n  link: {\n    text: string\n    href: string\n  },\n  children: ReactNode\n}\n\nconst Note = ( { link: { text, href }, children }: INote ) => {\n  return (\n    <p className={ styles.note }>\n      { children } <Link to={ href } className={ styles.link }>{ text }</Link>\n    </p>\n  );\n};\n\nexport default Note;\n","interface ICookieOptions {\n  expires?: Date | number | string;\n  path?: string;\n  domain?: string;\n  secure?: boolean;\n\n  [propName: string]: any;\n};\n\nexport function setCookie(\n  name: string,\n  value: string,\n  options: ICookieOptions\n) {\n\n  if ( options.expires instanceof Date ) {\n    options.expires = options.expires.toUTCString();\n  }\n\n  let updatedCookie = encodeURIComponent( name ) + '=' + encodeURIComponent( value );\n\n  for ( let optionKey in options ) {\n    updatedCookie += '; ' + optionKey;\n    let optionValue = options[optionKey];\n\n    if ( !optionValue ) {\n      updatedCookie += '=' + optionValue;\n    }\n  }\n\n  document.cookie = updatedCookie;\n}\n\nexport function deleteCookie( name: string ) {\n  setCookie( name, '', {\n    'max-age': -1\n  } );\n}\n\nexport function getCookie( name: string ) {\n  const matches = document.cookie.match(\n    // eslint-disable-next-line\n    new RegExp( '(?:^|; )' + name.replace( /([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1' ) + '=([^;]*)' )\n  );\n  return matches ? decodeURIComponent( matches[1] ) : undefined;\n}\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\nimport { IAsyncThunkExtraArgument, TUserData } from '../../types';\nimport { setCookie } from '../../utils/cookie';\n\ninterface ILoginState {\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: ILoginState = {\n  loading: false,\n  error: null,\n};\n\nconst login = createAsyncThunk<\n  void,\n  TUserData,\n  IAsyncThunkExtraArgument\n>\n(\n  'login/login',\n  async ( userData, { extra } ) => {\n    const response = await extra.login( userData );\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n\n    const { accessToken, refreshToken } = json;\n\n    setCookie( 'token', accessToken, { 'max-age': 1200 } );\n    setCookie( 'refreshToken', refreshToken, { 'max-age': 120000 } );\n\n    return json;\n  }\n);\n\nconst loginSlice = createSlice( {\n  name: 'login',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( login.fulfilled, ( state ) => {\n      state.loading = false;\n      state.error = null;\n    } )\n    .addCase( login.pending, ( state ) => {\n      state.loading = true;\n    } )\n    .addCase( login.rejected, ( state, action ) => {\n      state.loading = false;\n      state.error = action.error;\n    } );\n  }\n} );\n\nexport { login };\n\nexport default loginSlice.reducer;\n","import React, { useState, useCallback } from 'react';\nimport { useSelector, useDispatch } from '../../hooks';\nimport { Redirect, useLocation } from 'react-router-dom';\n\nimport { PasswordInput, EmailInput } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport FormPageTemplate from '../../components/form-page-template/form-page-template';\nimport Note from '../../components/note/note';\nimport Spinner from '../../components/spinner/spinner';\n\nimport { login } from '../../store/slices/login';\n\nconst LoginPage = () => {\n  const dispatch = useDispatch();\n  const { state } = useLocation<{from?: string}>();\n\n  const [ inputsData, setInputsData ] = useState( {\n    email: '',\n    password: ''\n  } );\n\n  const onFormSubmit = useCallback(\n    ( evt ) => {\n      evt.preventDefault();\n      dispatch( login( inputsData ) );\n    },\n    [inputsData, dispatch]\n  );\n\n  const onInputChange = useCallback( ( evt ) => {\n    const { name, value } = evt.target;\n\n    setInputsData( ( state ) => {\n      return {\n        ...state,\n        [name]: value\n      };\n    } );\n  }, [] );\n\n  const { loading, error } = useSelector(\n    ( state ) => state.login\n  );\n\n  const isLogin = useSelector(\n    ( state ) => state.profile.user.isLogin\n  );\n\n  if ( isLogin ) {\n    return <Redirect to={ state?.from || '/' } />;\n  }\n\n  const inputs = [\n    <EmailInput\n      value={ inputsData.email }\n      onChange={ onInputChange }\n      name='email'\n      key='1'\n    />,\n    <PasswordInput\n      value={ inputsData.password }\n      onChange={ onInputChange }\n      name='password'\n      key='2'\n    />\n  ];\n\n  const notes = [\n    <Note link={ { text: 'Зарегистрироваться', href: 'register' } } key='1'>Вы — новый пользователь?</Note>,\n    <Note link={ { text: 'Восстановить пароль', href: 'forgot-password' } } key='2'>Забыли пароль?</Note>,\n  ];\n\n  return (\n    <>\n      { loading && ( <Spinner /> ) }\n      { !loading && (\n        <FormPageTemplate\n          inputs={ inputs }\n          notes={ notes }\n          title='Вход'\n          submitButtonText='Войти'\n          onFormSubmit={ onFormSubmit }\n          reqError={ error }\n        />\n      ) }\n    </>\n  );\n};\n\nexport default LoginPage;\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\nimport { IAsyncThunkExtraArgument, TUserData } from '../../types';\nimport { setCookie } from '../../utils/cookie';\n\ninterface IRegistrationState {\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: IRegistrationState = {\n  loading: false,\n  error: null,\n};\n\nconst register = createAsyncThunk<\n  TUserData,\n  TUserData,\n  IAsyncThunkExtraArgument\n>\n(\n  'registration/register',\n  async ( userData, { extra } ) => {\n    const response = await extra.register( userData );\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n\n    const { accessToken, refreshToken } = json;\n\n    setCookie( 'token', accessToken, { 'max-age': 1200 } );\n    setCookie( 'refreshToken', refreshToken, { 'max-age': 120000 } );\n\n    return json;\n  }\n);\n\nconst registrationSlice = createSlice( {\n  name: 'registration',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder.addCase( register.fulfilled, ( state ) => {\n      state.loading = false;\n      state.error = null;\n    } )\n    .addCase( register.pending, ( state ) => {\n      state.loading = true;\n    } )\n    .addCase( register.rejected, ( state, action ) => {\n      state.loading = false;\n      state.error = action.error;\n    } );\n  }\n} );\n\nexport { register };\nexport default registrationSlice.reducer;\n","import React, { useState, useCallback } from 'react';\nimport { useSelector, useDispatch } from '../../hooks';\nimport { Redirect } from 'react-router-dom';\n\nimport { PasswordInput, EmailInput, Input } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport FormPageTemplate from '../../components/form-page-template/form-page-template';\nimport Note from '../../components/note/note';\nimport Spinner from '../../components/spinner/spinner';\n\nimport { register } from '../../store/slices/registration';\n\nconst RegistrationPage = () => {\n  const dispatch = useDispatch();\n\n  const [ inputsData, setInputsData ] = useState( {\n    name: '',\n    email: '',\n    password: ''\n  } );\n\n  const onFormSubmit = useCallback(\n    ( evt ) => {\n      evt.preventDefault();\n      dispatch( register( inputsData ) );\n    },\n    [inputsData, dispatch]\n  );\n\n  const onInputChange = useCallback( ( evt ) => {\n    const { name, value } = evt.target;\n\n    setInputsData( ( state ) => {\n      return {\n        ...state,\n        [name]: value\n      };\n    } );\n  }, [] );\n\n   const { loading, error } = useSelector(\n    ( state ) => state.registration\n  );\n\n  const isLogin = useSelector(\n    ( state ) => state.profile.user.isLogin\n  );\n\n  if ( isLogin ) {\n    return <Redirect to='/'/>;\n  }\n\n  const inputs = [\n    <Input\n      onChange={ onInputChange }\n      value={ inputsData.name }\n      name='name'\n      key='1'\n      type='text'\n      placeholder='Имя'\n     />,\n    <EmailInput\n      onChange={ onInputChange }\n      value={ inputsData.email }\n      name='email'\n      key='2'\n     />,\n    <PasswordInput\n      onChange={ onInputChange }\n      value={ inputsData.password }\n      name='password'\n      key='3'\n     />\n  ];\n\n  const notes = [\n    <Note key='1' link={ { text: 'Войти', href: '/login' } }>Уже зарегистрированы?</Note>\n  ];\n\n  return (\n    <>\n      { loading && ( <Spinner /> ) }\n      { !loading && (\n        <FormPageTemplate\n          inputs={ inputs }\n          notes={ notes }\n          title='Регистрация'\n          submitButtonText='Зарегистрироваться'\n          onFormSubmit={ onFormSubmit }\n          reqError={ error }\n        />\n      ) }\n    </>\n  );\n};\n\nexport default RegistrationPage;\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\nimport { IAsyncThunkExtraArgument } from '../../types';\n\ninterface IForgotPasswordState {\n  emailChecked: boolean;\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: IForgotPasswordState = {\n  emailChecked: false,\n  loading: false,\n  error: null,\n};\n\nconst checkEmailForPassReset = createAsyncThunk<\n  void,\n  string,\n  IAsyncThunkExtraArgument\n>\n(\n  'forgotPassword/checkEmailForPassReset',\n  async ( email, { extra } ) => {\n    const response = await extra.checkEmailForPassReset( email );\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n\n    return json.success;\n  }\n);\n\nconst forgotPasswordSlice = createSlice( {\n  name: 'forgotPassword',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( checkEmailForPassReset.fulfilled, ( state ) => {\n      state.loading = false;\n      state.error = null;\n      state.emailChecked = true;\n    } )\n    .addCase( checkEmailForPassReset.pending, ( state ) => {\n      state.loading = true;\n      state.error = null;\n    } )\n    .addCase( checkEmailForPassReset.rejected, ( state, action ) => {\n      state.loading = false;\n      state.error = action.error;\n    } );\n  }\n} );\n\nexport { checkEmailForPassReset };\n\nexport default forgotPasswordSlice.reducer;\n","import React, { useState, useCallback } from 'react';\nimport { useSelector, useDispatch } from '../../hooks';\nimport { Redirect, useLocation } from 'react-router-dom';\n\nimport { EmailInput } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport FormPageTemplate from '../../components/form-page-template/form-page-template';\nimport Note from '../../components/note/note';\nimport Spinner from '../../components/spinner/spinner';\n\nimport { checkEmailForPassReset } from '../../store/slices/forgot-password';\n\nconst ForgotPasswordPage = () => {\n  const location = useLocation();\n  const dispatch = useDispatch();\n\n  const [ email, setEmail ] = useState( '' );\n\n  const onEmailInput = useCallback(\n    ( evt ) => {\n      setEmail( evt.target.value );\n    },\n    []\n  );\n\n  const onFormSubmit = useCallback(\n    async ( evt ) => {\n      evt.preventDefault();\n      dispatch( checkEmailForPassReset( email ) );\n    },\n    [email, dispatch]\n  );\n\n  const inputs = [\n    <EmailInput key='1' name='email' value={ email } onChange={ onEmailInput } />,\n  ];\n\n  const notes = [\n    <Note key='1' link={ { text: 'Войти', href: '/login' } }>Вспомнили пароль?</Note>\n  ];\n\n  const { loading, error, emailChecked } = useSelector(\n    ( state ) => state.forgotPassword\n  );\n\n  const isLogin = useSelector(\n    ( state ) => state.profile.user.isLogin\n  );\n\n  if ( isLogin ) {\n    return <Redirect to='/'/>;\n  }\n\n  return (\n    <>\n      { loading && ( <Spinner /> ) }\n      { emailChecked && (\n        <Redirect to={ {\n          pathname: '/reset-password',\n          state: { from: location.pathname }\n        } }/>\n      ) }\n      { !loading && (\n        <FormPageTemplate\n          inputs={ inputs }\n          notes={ notes }\n          title='Восстановление пароля'\n          submitButtonText='Восстановить'\n          onFormSubmit={ onFormSubmit }\n          reqError={ error }\n        />\n      ) }\n    </>\n  );\n};\n\nexport default ForgotPasswordPage;\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\nimport { IAsyncThunkExtraArgument, TUserData } from '../../types';\n\ninterface IResetPasswordState {\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: IResetPasswordState = {\n  loading: false,\n  error: null,\n};\n\nconst resetPassword = createAsyncThunk<\n  void,\n  TUserData,\n  IAsyncThunkExtraArgument\n>\n(\n  'resetPassword/reset',\n  async ( userData, { extra } ) => {\n    const response = await extra.resetPassword( userData );\n\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n    return json;\n  }\n);\n\nconst resetPasswordSlice = createSlice( {\n  name: 'resetPassword',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder.addCase( resetPassword.fulfilled, ( state ) => {\n      state.loading = false;\n      state.error = null;\n    } )\n    .addCase( resetPassword.pending, ( state ) => {\n      state.loading = true;\n    } )\n    .addCase( resetPassword.rejected, ( state, action ) => {\n      state.loading = false;\n      state.error = action.error;\n    } );\n  }\n} );\n\nexport { resetPassword };\n\nexport default resetPasswordSlice.reducer;\n","import React, { useCallback, useState } from 'react';\nimport { useDispatch, useSelector } from '../../hooks';\nimport { Redirect, useLocation } from 'react-router-dom';\n\nimport { Input, PasswordInput } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport FormPageTemplate from '../../components/form-page-template/form-page-template';\nimport Note from '../../components/note/note';\nimport Spinner from '../../components/spinner/spinner';\n\nimport { resetPassword } from '../../store/slices/reset-password';\n\nconst ResetPasswordPage = () => {\n  const { state } = useLocation<{from?: string}>();\n  const dispatch = useDispatch();\n\n  const [ inputsData, setInputsData ] = useState( {\n    token: '',\n    password: ''\n  } );\n\n  const onFormSubmit = useCallback(\n    ( evt ) => {\n      evt.preventDefault();\n\n      dispatch( resetPassword( inputsData ) );\n    },\n    [inputsData, dispatch]\n  );\n\n  const onInputChange = useCallback( ( evt ) => {\n    const { name, value } = evt.target;\n\n    setInputsData( ( state ) => {\n      return {\n        ...state,\n        [name]: value\n      };\n    } );\n  }, [] );\n\n  const { loading, error } = useSelector(\n    ( state ) => state.resetPassword\n  );\n\n  const isLogin = useSelector(\n    ( state ) => state.profile.user.isLogin\n  );\n\n  const emailChecked = useSelector(\n    ( state ) => state.forgotPassword.emailChecked\n  );\n\n  if ( isLogin || !emailChecked || state?.from !== '/forgot-password' ) {\n    return <Redirect to='/'/>;\n  }\n\n  const inputs = [\n    <PasswordInput\n      value={ inputsData.password }\n      onChange={ onInputChange }\n      key='1'\n      name='password'\n    />,\n    <Input\n      value={ inputsData.token }\n      onChange={ onInputChange }\n      key='2'\n      type='text'\n      placeholder='Введите код из письма'\n      name='token'\n    />\n  ];\n\n  const notes = [\n    <Note key='1' link={ { text: 'Войти', href: '/login' } }>Вспомнили пароль?</Note>\n  ];\n\n  return (\n    <>\n      { loading && ( <Spinner /> ) }\n      { !loading && (\n        <FormPageTemplate\n          inputs={ inputs }\n          notes={ notes }\n          title='Сброс пароля'\n          submitButtonText='Сохранить'\n          onFormSubmit={ onFormSubmit }\n          reqError={ error }\n        />\n      ) }\n    </>\n  );\n};\n\nexport default ResetPasswordPage;\n","import { createAsyncThunk, createSlice, isPending, isRejected, isFulfilled, SerializedError } from '@reduxjs/toolkit';\n\nimport { login } from './login';\nimport { register } from './registration';\n\nimport { getCookie, deleteCookie } from '../../utils/cookie';\n\nimport { IAsyncThunkExtraArgument, TUserData } from '../../types';\n\nconst isLogin = !!getCookie( 'token' );\n\ninterface IProfileState {\n  user: TUserData & { isLogin: boolean },\n  loading: boolean\n  error: SerializedError | null\n}\n\nexport const initialState: IProfileState = {\n  user: {\n    email: '',\n    name: '',\n    isLogin,\n  },\n  loading: false,\n  error: null,\n};\n\nconst logout = createAsyncThunk<\n  {},\n  void,\n  IAsyncThunkExtraArgument\n>\n(\n  'profile/logout',\n  async ( _, { extra } ) => {\n    const response = await extra.logout();\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n\n    deleteCookie( 'token' );\n\n    return json;\n  }\n);\n\nconst getUserData = createAsyncThunk<\n  {user: TUserData & { isLogin?: boolean } },\n  void,\n  IAsyncThunkExtraArgument\n>\n(\n  'profile/getUserData',\n  async ( _, { extra } ) => {\n    const response = await extra.getUserData();\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n\n    return json;\n  }\n);\n\nconst setUserData = createAsyncThunk<\n  {user: TUserData & { isLogin?: boolean } },\n  TUserData,\n  IAsyncThunkExtraArgument\n>\n(\n  'profile/setUserData',\n  async ( userData, { extra } ) => {\n    const response = await extra.setUserData( userData );\n    const json = await response.json();\n\n    if ( !json.success ) {\n      throw new Error( json.message );\n    }\n\n    return json;\n  }\n);\n\nconst isPendingAction = isPending( logout, getUserData, setUserData );\nconst isRejectedAction = isRejected( logout, getUserData, setUserData );\nconst isFulfilledAction = isFulfilled( register, login );\n\nconst profileSlice = createSlice( {\n  name: 'profile',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( logout.fulfilled, ( state ) => {\n        state.user.isLogin = false;\n      } )\n      .addCase( getUserData.fulfilled, ( state, { payload: { user } } ) => {\n        state.user = { ...user, isLogin: true };\n        state.loading = false;\n        state.error = null;\n      } )\n      .addCase( setUserData.fulfilled, ( state, { payload: { user } } ) => {\n        state.user = { ...user, isLogin: true };\n        state.loading = false;\n        state.error = null;\n      } )\n      .addMatcher(\n        isFulfilledAction,\n        ( state, payload ) => {\n          state.user = { ...payload, isLogin: true };\n        } )\n      .addMatcher(\n        isPendingAction,\n        ( state, _ ) => {\n          state.loading = true;\n          state.error = null;\n        } )\n      .addMatcher(\n        isRejectedAction,\n        ( state, action ) => {\n          state.loading = false;\n          state.error = action.error;\n          state.user = {\n            email: '',\n            name: '',\n            isLogin: !!getCookie( 'token' )\n          };\n        }\n      );\n  }\n} );\n\nexport { logout, getUserData, setUserData };\nexport default profileSlice.reducer;\n","import React, { useState, useCallback, useEffect } from 'react';\nimport { useSelector, useDispatch } from '../../hooks';\nimport { Input, EmailInput, PasswordInput, Button } from '@ya.praktikum/react-developer-burger-ui-components';\n\nimport Spinner from '../spinner/spinner';\nimport Error from '../error/error';\n\nimport { getUserData, setUserData } from '../../store/slices/profile';\n\nimport styles from './user-form.module.css';\n\nconst UserForm = () => {\n  const dispatch = useDispatch();\n\n  const profileData = useSelector( ( state ) => state.profile );\n  const userData = profileData.user;\n  const { loading, error } = profileData;\n\n  const [ inputsData, setInputsData ] = useState( {\n    name: '',\n    email: '',\n    password: ''\n  } );\n\n  useEffect( () => {\n    dispatch( getUserData() );\n  }, [dispatch] );\n\n  useEffect( () => {\n    const { name, email } = userData;\n\n    if( name && email ) {\n      setInputsData( {\n        name,\n        email,\n        password: ''\n      } );\n    }\n  }, [userData] );\n\n  const onInputChange = useCallback( ( evt ) => {\n    const { name, value } = evt.target;\n\n    setInputsData( ( state ) => {\n      return {\n        ...state,\n        [name]: value\n      };\n    } );\n  }, [] );\n\n  const formSubmitHandler = useCallback( ( evt ) => {\n    evt.preventDefault();\n    dispatch( setUserData( inputsData ) );\n  }, [ dispatch, inputsData ] );\n\n  const onCancelBtnClick = useCallback( () => {\n    if ( userData.name && userData.email ) {\n      setInputsData( {\n        name: userData.name,\n        email: userData.email,\n        password: ''\n      } );\n    }\n  }, [userData] );\n\n  return (\n    <>\n      { loading && ( <Spinner /> ) }\n      { error && ( <Error error={ error } /> ) }\n      { !loading && !error && (\n        <form onSubmit={ formSubmitHandler } className={ styles.form }>\n          <h1 className='visually-hidden'>В этом разделе вы можете изменить свои персональные данные</h1>\n          <Input\n            onChange={ onInputChange }\n            value={ inputsData.name }\n            name='name'\n            type='text'\n            placeholder='Имя'\n            icon='EditIcon'\n          />\n          <EmailInput\n            onChange={ onInputChange }\n            value={ inputsData.email }\n            name='email'\n          />\n          <PasswordInput\n            onChange={ onInputChange }\n            value={ inputsData.password }\n            name='password'\n          />\n          <div className={ styles.flex }>\n            <Button size='medium' type='primary'>Сохранить</Button>\n            <Button onClick={ onCancelBtnClick } size='medium' type='secondary'>Отмена</Button>\n          </div>\n        </form>\n      ) }\n    </>\n  );\n};\n\nexport default UserForm;\n","import React from 'react';\n\nimport styles from './ingredient-preview.module.css';\n\nimport { TIngredient } from '../../types';\n\ninterface IIngredientPreview {\n  ingredient: TIngredient,\n  more: number | null\n}\n\nconst IngredientPreview = (\n  { ingredient: { name, image_mobile }, more }: IIngredientPreview\n) => (\n  <div className={ styles.ingredient }>\n    { more && <span className={ styles.more }>+{ more }</span> }\n    <picture>\n      <img src={ image_mobile } alt={ name } />\n    </picture>\n  </div>\n);\n\nexport default IngredientPreview;\n","const MS_IN_DAY = 60 * 60 * 24 * 1000;\n\nconst DAYS_MAP: ReadonlyArray<string> = ['сегодня', 'вчера'];\n\nconst getNormalizedDateTimeString = ( dateTimeISOstring: string ) => {\n  const date = new Date( dateTimeISOstring );\n\n  const time = new Intl.DateTimeFormat( 'ru-ru',\n    {\n      timeZoneName: 'short',\n      hour: '2-digit',\n      minute: '2-digit'\n    }\n  )\n  .format( date )\n  .replace( 'GMT', 'i-GMT' );\n\n  const dayDifference = Math.trunc( ( +new Date() - +date ) / MS_IN_DAY );\n\n  if ( dayDifference <= 1 && dayDifference >= 0 ) {\n    return `${ DAYS_MAP[dayDifference] }, ${ time }`;\n  }\n\n  return `${\n    dayDifference\n  } ${\n    declOfNum( dayDifference, ['день', 'дня', 'дней'] )\n  } назад, ${\n    time\n  }`;\n};\n\nfunction declOfNum( number: number, titles: Array<string> ) {\n  const cases = [2, 0, 1, 1, 1, 2];\n  return titles[ ( number%100>4 && number%100<20 )? 2 : cases[( number%10<5 )?number%10:5] ];\n}\n\nexport default getNormalizedDateTimeString;\n","import { TOrderStatuses } from '../types';\r\n\r\nconst BASE_URL = 'norma.nomoreparties.space';\r\n\r\nexport const INGREDIENTS_ULR =\r\n  'https://' + BASE_URL + '/api/ingredients';\r\n\r\nexport const ORDERS_URL =\r\n  'https://' + BASE_URL + '/api/orders';\r\n\r\nexport const PASSWORD_RESET_URL =\r\n  'https://' + BASE_URL + '/api/password-reset';\r\n\r\nexport const LOGIN_URL =\r\n  'https://' + BASE_URL + '/api/auth/login';\r\n\r\nexport const REGISTER_URL =\r\n  'https://' + BASE_URL + '/api/auth/register';\r\n\r\nexport const LOGOUT_URL =\r\n  'https://' + BASE_URL + '/api/auth/logout';\r\n\r\nexport const TOKEN_REFRESH_URL =\r\n  'https://' + BASE_URL + '/api/auth/token';\r\n\r\nexport const USER_DATA_URL =\r\n  'https://' + BASE_URL + '/api/auth/user';\r\n\r\nexport const WS_ALL_ORDERS_URL =\r\n  'wss://' + BASE_URL + '/orders/all';\r\n\r\nexport const WS_USER_ORDERS_URL =\r\n  'wss://' + BASE_URL + '/orders';\r\n\r\nexport const ORDER_STATUSES: TOrderStatuses = {\r\n  done: 'Выполнен',\r\n  pending: 'Готовится',\r\n  created: 'Создан',\r\n  cancel: 'Отменен'\r\n};\r\n","import React, { useMemo } from 'react';\nimport { useSelector } from '../../hooks';\n\nimport IngredientPreview from '../ingredient-preview/ingredient-preview';\nimport Price from '../price/price';\n\nimport getId from '../../utils/getId';\nimport getNormalizedDateTimeString from '../../utils/getNormalizedDateTimeString';\n\nimport styles from './order-card.module.css';\n\nimport { ORDER_STATUSES } from '../../utils/constants';\n\nimport { TOrderData, TIngredient } from '../../types';\n\nconst OrderCard = ( { orderData }: { orderData: TOrderData } ) => {\n  const { number, createdAt, name, status, ingredients } = orderData;\n\n  const allBurgerIngredients = useSelector( ( state ) => state.burgerIngredients.items );\n\n  const ingredientsData = useMemo( () => {\n    return allBurgerIngredients.filter( ( ingredient ) => ingredients.includes( ingredient._id ) );\n  }, [ allBurgerIngredients, ingredients ] );\n\n  const price = useMemo( () => {\n    return ingredientsData.reduce( ( acc, current ) => acc + current.price, 0 );\n  }, [ ingredientsData ] );\n\n  const statusAddClassName =\n    status === 'done' ? 'success' :\n    status === 'cancel' ? 'error' :\n        '';\n\n  const statusText = ORDER_STATUSES[ status ];\n\n  return (\n    <article className={ styles.card }>\n      <header className={ styles.header }>\n        <span className={ styles.id }>#{ number }</span>\n        <time dateTime={ createdAt } className={ styles.time }>{ getNormalizedDateTimeString( createdAt ) }</time>\n      </header>\n      <h2 className={ styles.title }>{ name }</h2>\n      <p className={\n        `${ styles.status } ${ statusAddClassName }` }\n      >\n        { statusText }\n      </p>\n      <div className={ styles.main }>\n        <ul className={ styles.ingredients }>\n          {\n            renderPreviews( ingredientsData )\n          }\n        </ul>\n        <Price>{ price }</Price>\n      </div>\n    </article>\n  );\n};\n\nexport default OrderCard;\n\nconst renderPreviews = ( ingredients: TIngredient[] ) => {\n  const previews = [];\n\n  for ( let index = 0; index < ingredients.length; index++ ) {\n    const ingredient = ingredients[ index ];\n    let more = null;\n    if ( index === 5 ) {\n      more = ingredients.length - 5;\n    }\n\n    const key = getId();\n    previews.push(\n      <li key={ key } style={ { zIndex: ingredients.length - index } }>\n        <IngredientPreview more={ more } ingredient={ ingredient } />\n      </li>\n    );\n\n    if ( more !== null ) break;\n  }\n\n  return previews;\n};\n","import React from 'react';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport OrderCard from '../order-card/order-card';\n\nimport styles from './orders-feed.module.css';\nimport { TUserOrderData } from '../../types';\n\nconst OrdersFeed = ( { ordersData }: {ordersData: Array<TUserOrderData>} ) => {\n  const location = useLocation();\n  if ( !ordersData.length ) {\n    return <p className={ styles.text }>Заказов нет</p>;\n  }\n  return (\n    <>\n      <h1 className='visually-hidden'>История заказов</h1>\n      <ul className={ styles.list }>\n        {\n          ordersData.map( ( orderData ) => (\n            <li key={ orderData._id } className={ styles.item }>\n              <Link to={ {\n                pathname: `${ location.pathname }/${ orderData.number }`,\n                state: { from: location.pathname, orderLocation: location }\n              } } className={ styles.link }>\n                <OrderCard orderData={ orderData } />\n              </Link>\n            </li>\n          ) )\n        }\n      </ul>\n    </>\n  );\n};\n\nexport default OrdersFeed;\n","import { createSlice } from '@reduxjs/toolkit';\nimport { TUserOrderData } from '../../types';\n\ninterface IAllOrdersFeedState {\n  orders: TUserOrderData[];\n  total: number;\n  totalToday: number;\n  wsConnected: boolean;\n  error: boolean;\n}\n\nexport const initialState: IAllOrdersFeedState = {\n  orders: [],\n  total: 0,\n  totalToday: 0,\n  wsConnected: false,\n  error: false,\n};\n\nconst allOrdersFeedSlice = createSlice( {\n  name: 'allOrdersFeed',\n  initialState,\n  reducers: {\n    wsConnectionSuccess: ( state ) => {\n      state.wsConnected = true;\n      state.error = false;\n    },\n    wsConnectionError: ( state ) => {\n      state.wsConnected = false;\n      state.error = true ;\n    },\n    wsConnectionClosed: ( state ) => {\n      state.wsConnected = false;\n    },\n    wsGetMessage: ( state, action ) => {\n      const { orders, total, totalToday, success } = action.payload;\n      if ( !success ) {\n        state.error = true;\n        return;\n      };\n\n      state.orders = orders;\n      state.total = total;\n      state.totalToday = totalToday;\n    }\n  },\n} );\n\nexport default allOrdersFeedSlice.reducer;\nexport const {\n  wsConnectionSuccess,\n  wsConnectionError,\n  wsConnectionClosed,\n  wsGetMessage\n} = allOrdersFeedSlice.actions;\n","import {\n  wsConnectionSuccess,\n  wsConnectionError,\n  wsConnectionClosed,\n  wsGetMessage\n} from '../slices/all-orders-feed';\n\nconst allOrdersFeedActions = {\n  onOpen: wsConnectionSuccess,\n  onError: wsConnectionError,\n  onClose: wsConnectionClosed,\n  onMessage: wsGetMessage\n};\n\nexport default allOrdersFeedActions;\n","import { createSlice } from '@reduxjs/toolkit';\nimport { TUserOrderData } from '../../types';\n\ninterface IUserOrdersFeedState {\n  orders: TUserOrderData[];\n  wsConnected: boolean;\n  error: boolean;\n}\n\nexport const initialState: IUserOrdersFeedState = {\n  orders: [],\n  wsConnected: false,\n  error: false,\n};\n\nconst userOrdersFeedSlice = createSlice( {\n  name: 'userOrdersFeed',\n  initialState,\n  reducers: {\n    wsConnectionSuccess: ( state ) => {\n      state.wsConnected = true;\n      state.error = false;\n    },\n    wsConnectionError: ( state ) => {\n      state.wsConnected = false;\n      state.error = true;\n    },\n    wsConnectionClosed: ( state ) => {\n      state.wsConnected = false;\n    },\n    wsGetMessage: ( state, action ) => {\n      const { orders, success } = action.payload;\n      if ( !success ) {\n        state.error = true;\n        return;\n      };\n\n      state.orders = orders;\n    }\n  },\n} );\n\nexport default userOrdersFeedSlice.reducer;\nexport const {\n  wsConnectionSuccess,\n  wsConnectionError,\n  wsConnectionClosed,\n  wsGetMessage\n} = userOrdersFeedSlice.actions;\n","import allOrdersFeedActions from './ws-all-orders-feed-actions';\nimport userOrdersFeedActions from './ws-user-orders-feed-actions';\nimport commonActions from './ws-common-actions';\n\ntype TWsActions = {\n  allOrders: typeof allOrdersFeedActions;\n  userOrders: typeof userOrdersFeedActions;\n  common: typeof commonActions;\n  [k: string]: any;\n};\n\nconst wsActions:TWsActions = {\n  allOrders: allOrdersFeedActions,\n  userOrders: userOrdersFeedActions,\n  common: commonActions\n};\n\nexport default wsActions;\n","import {\n  wsConnectionSuccess,\n  wsConnectionError,\n  wsConnectionClosed,\n  wsGetMessage\n} from '../slices/user-orders-feed';\n\nconst userOrdersFeedActions = {\n  onOpen: wsConnectionSuccess,\n  onError: wsConnectionError,\n  onClose: wsConnectionClosed,\n  onMessage: wsGetMessage\n};\n\nexport default userOrdersFeedActions;\n","import { createAction, PayloadActionCreator } from '@reduxjs/toolkit';\n\ninterface IWsCommonActions {\n  wsConnectionInit: PayloadActionCreator<string>;\n  wsConnectionClose: PayloadActionCreator\n}\n\nconst wsCommonActions: IWsCommonActions = {\n  wsConnectionInit: createAction( 'WS_CONNECTION_INIT' ),\n  wsConnectionClose: createAction( 'WS_CONNECTION_CLOSE' )\n};\n\nexport default wsCommonActions;\n","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from '../../hooks';\n\nimport OrdersFeed from '../orders-feed/orders-feed';\nimport ScrolledContainer from '../scrolled-container/scrolled-container';\nimport Spinner from '../../components/spinner/spinner';\nimport Error from '../../components/error/error';\n\nimport wsActions from '../../store/ws-actions';\n\nconst UserOrdersFeed = () => {\n  const dispatch = useDispatch();\n\n  const {\n    orders,\n    wsConnected,\n    error,\n  } = useSelector( ( state ) => state.userOrdersFeed );\n\n  useEffect( () => {\n    dispatch( wsActions.common.wsConnectionInit( 'userOrders' ) );\n\n    return () => {\n      dispatch( wsActions.common.wsConnectionClose() );\n    };\n  }, [ dispatch ] );\n\n  return (\n    <>\n      { !wsConnected && !error && <Spinner/> }\n      { error && <Error error={ { message: 'Соединение прервано' } } /> }\n      { wsConnected && !error && (\n        <ScrolledContainer maxHeight='70vh'>\n          <OrdersFeed ordersData={ orders } />\n        </ScrolledContainer>\n      ) }\n    </>\n\n  );\n};\n\nexport default UserOrdersFeed;\n","import React, { useCallback } from 'react';\nimport { useDispatch } from '../../hooks';\nimport { NavLink, useRouteMatch, Route, Switch, useHistory } from 'react-router-dom';\n\nimport UserForm from '../../components/user-form/user-form';\nimport UserOrdersFeed from '../../components/user-orders-feed/user-orders-feed';\nimport ScrolledContainer from '../../components/scrolled-container/scrolled-container';\n\nimport { logout } from '../../store/slices/profile';\n\nimport styles from './profile.module.css';\n\nconst ProfilePage = () => {\n  const history = useHistory();\n  const dispatch = useDispatch();\n\n  const onLogoutBtnClick = useCallback( ( evt ) => {\n    evt.preventDefault();\n\n    dispatch( logout() );\n    history.push( { pathname: '/login', state: { from: '/login' } } );\n  }, [dispatch, history] );\n\n  const { path, url } = useRouteMatch();\n\n  return (\n    <div className={ styles.wrapper }>\n      <div className={ styles['side-bar'] }>\n        <nav className={ styles.nav }>\n          <ul className={ styles.list }>\n            <li className={ styles.item }>\n              <NavLink exact={ true } className={ styles.link } to={ url }>Профиль</NavLink>\n            </li>\n            <li className={ styles.item }>\n              <NavLink className={ styles.link } to={ `${ url }/orders` }>История заказов</NavLink>\n            </li>\n            <li className={ styles.item }>\n              <a href='/login' onClick={ onLogoutBtnClick } className={ styles.link }>Выход</a>\n            </li>\n          </ul>\n        </nav>\n        <p className={ styles.description }>В этом разделе вы можете <br /> изменить свои персональные данные</p>\n      </div>\n      <div className={ styles.main }>\n        <Switch>\n          <Route exact={ true } path={ path }>\n            <UserForm/>\n          </Route>\n          <Route exact={ true } path={ `${ path }/orders` }>\n            <ScrolledContainer maxHeight='868px'>\n              <UserOrdersFeed />\n            </ScrolledContainer>\n          </Route>\n        </Switch>\n      </div>\n    </div>\n  );\n};\n\nexport default ProfilePage;\n","import React from 'react';\r\n\r\nimport { useSelector } from '../../hooks';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nimport styles from './ingredient-details.module.css';\r\n\r\ninterface IIngredientDetails {\r\n  id: string\r\n}\r\n\r\nconst IngredientDetails = () => {\r\n  const { id } = useParams<IIngredientDetails>();\r\n\r\n  const ingredient = useSelector(\r\n    ( state ) => state.burgerIngredients.items\r\n      .find( ( { _id } ) => _id === id )\r\n  );\r\n\r\n  if ( !ingredient ) {\r\n    return <p>Ингредиент не найден</p>;\r\n  }\r\n\r\n  const {\r\n    name,\r\n    image_large,\r\n    calories,\r\n    proteins,\r\n    fat,\r\n    carbohydrates\r\n  } = ingredient;\r\n\r\n  return (\r\n    <article className={ styles.details }>\r\n      <figure className={ styles.figure }>\r\n        <picture>\r\n          <img className={ styles.image } src={ image_large } alt={ name } />\r\n        </picture>\r\n        <figcaption>\r\n          <h1 className={ styles.title }>{ name }</h1>\r\n        </figcaption>\r\n      </figure>\r\n      <table className={ styles.evergy }>\r\n        <caption className='visually-hidden'>Энергетическая ценность</caption>\r\n        <thead>\r\n          <tr>\r\n            <th className={ styles.th }>Калории,ккал</th>\r\n            <th className={ styles.th }>Белки, г</th>\r\n            <th className={ styles.th }>Жиры, г</th>\r\n            <th className={ styles.th }>Углеводы, г</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr>\r\n            <td className={ styles.td }>{ calories }</td>\r\n            <td className={ styles.td }>{ proteins }</td>\r\n            <td className={ styles.td }>{ fat }</td>\r\n            <td className={ styles.td }>{ carbohydrates }</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </article>\r\n  );\r\n};\r\n\r\nexport default IngredientDetails;\r\n","import React from 'react';\nimport IngredientDetails from '../../components/ingredient-details/ingredient-details';\n\nimport styles from './ingredient-page.module.css';\n\nconst IngredientPage = () => (\n  <div className={ styles.wrapper }>\n    <h1 className={ styles.title }>Детали ингредиента</h1>\n    <IngredientDetails />\n  </div>\n);\n\nexport default IngredientPage;\n","import React from 'react';\n\nimport styles from './orders-stats.module.css';\n\ninterface IOrdersStats {\n  done: Array<number>,\n  inWork: Array<number>,\n  total: number,\n  totalToday: number;\n}\n\nconst OrdersStats = ( { done, inWork, total, totalToday }: IOrdersStats ) => {\n  return (\n    <table className={ styles.table }>\n      <caption className='visually-hidden'>Статистика заказов</caption>\n      <thead>\n        <tr>\n          <th className={ styles.th }>Готовы:</th>\n          <th className={ styles.th }>В работе:</th>\n        </tr>\n      </thead>\n      <tbody>\n        { renderTbodyRows( done, inWork ) }\n      </tbody>\n      <tfoot>\n        <tr>\n          <th className={ styles.th } colSpan={ 2 }>Выполнено за все время:</th>\n        </tr>\n        <tr>\n          <td className={ styles.td_large } colSpan={ 2 }>{ total }</td>\n        </tr>\n        <tr>\n          <th className={ styles.th } colSpan={ 2 }>Выполнено за сегодня:</th>\n        </tr>\n        <tr>\n          <td className={ styles.td_large } colSpan={ 2 }>{ totalToday }</td>\n        </tr>\n      </tfoot>\n    </table>\n  );\n};\n\nexport default OrdersStats;\n\nconst renderTbodyRows = ( done:Array<number>, inWork:Array<number> ) => {\n  const tbodyRows = [];\n  const arrForCycle = ( done.length > inWork.length ) ? done : inWork;\n\n  if ( arrForCycle.length >= 10 ) {\n    for ( let index = 0; index < arrForCycle.length; index += 2 ) {\n      if ( index >= 20 ) {\n        break;\n      }\n\n      const completeItem = done[index] || '';\n      const inWorkItem = inWork[ index ] || '';\n\n      const completeItemNext = done[index + 1] || '';\n      const inWorkItemNext = inWork[index + 1] || '';\n\n      tbodyRows.push(\n        <tr key={ index }>\n          <td\n            className={ `${ styles.td } ${ styles.quarter } ${ styles.done }` }\n          >\n            { completeItem }\n          </td>\n          <td\n            className={ `${ styles.td } ${ styles.quarter } ${ styles.done }` }\n          >\n            { completeItemNext }\n          </td>\n          <td\n            className={ `${ styles.td } ${ styles.quarter }` }>\n            { inWorkItem }\n          </td>\n          <td\n            className={ `${ styles.td } ${ styles.quarter }` }>\n            { inWorkItemNext }\n          </td>\n        </tr>\n      );\n    }\n\n    return tbodyRows;\n  }\n\n  for ( let index = 0; index < arrForCycle.length; index++ ) {\n    if ( index >= 20 ) {\n      break;\n    }\n\n    const completeItem = done[index] || '';\n    const inWorkItem = inWork[index] || '';\n\n    tbodyRows.push(\n      <tr key={ index }>\n        <td\n          className={ `${ styles.td } ${ styles.done }` }>\n          { completeItem }\n        </td>\n        <td\n          className={ `${ styles.td } ${ styles.done }` }>\n          { inWorkItem }\n        </td>\n      </tr>\n    );\n  }\n\n  return tbodyRows;\n};\n","import React, { useEffect, useMemo } from 'react';\nimport { useDispatch, useSelector } from '../../hooks';\n\nimport wsActions from '../../store/ws-actions/index';\n\nimport ScrolledContainer from '../../components/scrolled-container/scrolled-container';\nimport OrdersFeed from '../../components/orders-feed/orders-feed';\nimport OrdersStats from '../../components/orders-stats/orders-stats';\nimport Spinner from '../../components/spinner/spinner';\nimport Error from '../../components/error/error';\n\nimport styles from './feed.module.css';\n\nconst FeedPage = () => {\n  const dispatch = useDispatch();\n  const {\n    orders,\n    total,\n    totalToday,\n    wsConnected,\n    error,\n  } = useSelector( ( state ) => state.allOrdersFeed );\n\n  useEffect( () => {\n    dispatch( wsActions.common.wsConnectionInit( 'allOrders' ) );\n\n    return () => {\n      dispatch( wsActions.common.wsConnectionClose() );\n    };\n  }, [ dispatch ] );\n\n  const groupedByType = useMemo( () => {\n    const groups: {[k: string]: Array<number>} = {\n      done: [],\n      inWork: []\n    };\n\n    orders.forEach( ( order ) => {\n      const { status } = order;\n      groups[status].push( order.number );\n    } );\n\n    return groups;\n  }, [ orders ] );\n\n  return (\n    <>\n      { !wsConnected && !error && <Spinner/> }\n      { error && <Error error={ { message: 'Соединение прервано' } } /> }\n      { wsConnected && !error && total && (\n        <>\n          <h1 className={ styles.title }>Лента заказов</h1>\n          <div className={ styles.flex }>\n            <div className={ styles.column }>\n              <ScrolledContainer maxHeight='70vh'>\n                <OrdersFeed ordersData={ orders }/>\n              </ScrolledContainer>\n            </div>\n            <div className={ `${ styles.column } ${ styles['table-wrapper'] }` }>\n              <OrdersStats\n                done={ groupedByType.done }\n                inWork={ groupedByType.inWork }\n                total={ total }\n                totalToday={ totalToday }\n              />\n            </div>\n          </div>\n        </>\n      ) }\n    </>\n  );\n};\n\nexport default FeedPage;\n","import React from 'react';\n\nimport styles from './not-found-404.module.css';\n\nconst NotFound404 = () => {\n  return (\n    <div className={ styles.wrapper }>\n      <h1 className={ styles.text }>Страница не найдена!</h1>\n    </div>\n  );\n};\n\nexport default NotFound404;\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\n\nimport { IAsyncThunkExtraArgument, TUserOrder } from '../../types';\n\ninterface IUserOrderState {\n  orderData: TUserOrder | null;\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: IUserOrderState = {\n  orderData: null,\n  loading: false,\n  error: null,\n};\n\nconst getOrderById = createAsyncThunk<\n  TUserOrder,\n  string,\n  IAsyncThunkExtraArgument\n>\n(\n  'userOrder',\n  async ( id, { extra } ) => {\n    const response = await extra.getOrderById( id );\n    const json = await response.json();\n    return json;\n  }\n);\n\nconst userOrderSlice = createSlice( {\n  name: 'userOrder',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( getOrderById.fulfilled, ( state, action ) => {\n        state.loading = false;\n        state.orderData = action.payload;\n      } )\n      .addCase( getOrderById.pending, ( state ) => {\n        state.loading = true;\n        state.error = null;\n      } )\n      .addCase( getOrderById.rejected, ( state, action ) => {\n        state.loading = false;\n        state.error = action.error;\n        state.orderData = null;\n      } );\n  },\n} );\n\nexport { getOrderById };\nexport default userOrderSlice.reducer;\n","import React, { useMemo, useEffect } from 'react';\nimport { useParams } from 'react-router';\nimport { useSelector, useDispatch } from '../../hooks';\n\nimport ScrolledContainer from '../scrolled-container/scrolled-container';\nimport IngredientPreview from '../ingredient-preview/ingredient-preview';\nimport Price from '../price/price';\n\nimport Spinner from '../spinner/spinner';\nimport Error from '../error/error';\n\nimport { getOrderById } from '../../store/slices/user-order';\n\nimport getNormalizedDateTimeString from '../../utils/getNormalizedDateTimeString';\n\nimport styles from './order-info.module.css';\n\nimport { ORDER_STATUSES } from '../../utils/constants';\nimport { TIngredient } from '../../types';\n\nconst OrderInfo = () => {\n  const { id } = useParams<{id: string}>();\n  const dispatch = useDispatch();\n\n  const allBurgerIngredients = useSelector( ( state ) => state.burgerIngredients.items );\n\n  const { orderData, loading, error } = useSelector( ( state ) => state.userOrder );\n\n  const order = orderData ? orderData.orders[ 0 ] : null;\n\n  useEffect( () => {\n    dispatch( getOrderById( id ) );\n  }, [ dispatch, id ] );\n\n  const ingredientsData = useMemo( () => {\n    if ( !order ) {\n      return;\n    }\n\n    const { ingredients } = order;\n\n    const ingredientsData = allBurgerIngredients.filter( ( ingredient ) => ingredients.includes( ingredient._id ) );\n\n    const normalizedData:\n      {\n        [k: string]: TIngredient & {\n          amount: number\n        }\n      } = {};\n\n    ingredientsData.forEach( ( ingredient ) => {\n      normalizedData[ ingredient._id ] = { ...ingredient, amount: 1 };\n    } );\n\n    ingredients.forEach( ( ingredientId ) => {\n      normalizedData[ ingredientId ].amount += 1;\n    } );\n\n    return Object.values( normalizedData );\n  }, [ allBurgerIngredients, order ] );\n\n  const price = useMemo( () => {\n    if ( !ingredientsData ) {\n      return;\n    }\n\n    return ingredientsData.reduce( ( acc, current ) => acc + current.price * current.amount, 0 );\n  }, [ ingredientsData ] );\n\n  const statusAddClassName =\n    order?.status === 'done' ? 'success' :\n    order?.status === 'cancel' ? 'error' :\n    '';\n\n  return (\n    <>\n      { loading && <Spinner /> }\n      { error && <Error error={ error } /> }\n      { !loading && !error && order &&\n        (\n          <article className={ styles.card }>\n            <header className={ styles.header }>\n              <p className={ styles.id }>#{ order.number }</p>\n              <h1 className={ styles.title }>{ order.name }</h1>\n              <p className={ `${ styles.status } ${ statusAddClassName }` }>{ ORDER_STATUSES[ order.status ] }</p>\n            </header>\n            <h2 className={ styles[ 'structure-title' ] }>Состав:</h2>\n            <ScrolledContainer maxHeight='314px'>\n              <ul className={ styles.list }>\n                {\n                  ingredientsData?.map( ( ingredient ) => {\n                    return (\n                      <li key={ ingredient._id } className={ styles.item }>\n                        <article className={ styles.ingredient }>\n                          <IngredientPreview ingredient={ ingredient } more={ null } />\n                          <h3 className={ styles[ 'ingredient-name' ] }>{ ingredient.name }</h3>\n                          <Price>{ ingredient.amount } x { ingredient.price }</Price>\n                        </article>\n                      </li>\n                    );\n                  } )\n                }\n              </ul>\n            </ScrolledContainer>\n            <footer className={ styles.footer }>\n              <p className={ styles[ 'time-wrapper' ] }>\n                <time dateTime={ order.createdAt } className={ styles.time }>{ getNormalizedDateTimeString( order.createdAt ) }</time>\n              </p>\n              <Price>{ price }</Price>\n            </footer>\n          </article>\n        ) }\n    </>\n );\n};\n\nexport default OrderInfo;\n","import React from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\nimport { BurgerIcon, ListIcon } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './app-nav.module.css';\r\n\r\nconst AppNav = () => (\r\n  <nav>\r\n    <ul className={ styles.list }>\r\n      <li className={ styles.item }>\r\n        <NavLink to='/' exact={ true } className='nav-link'>\r\n          <BurgerIcon type='secondary' />\r\n          Конструктор\r\n        </NavLink>\r\n      </li>\r\n\r\n      <li>\r\n        <NavLink to='/feed' className='nav-link'>\r\n          <ListIcon type='secondary' />\r\n          Лента заказов\r\n        </NavLink>\r\n      </li>\r\n    </ul>\r\n  </nav>\r\n);\r\n\r\nexport default AppNav;\r\n","import React, { memo } from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\nimport { Logo, ProfileIcon } from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport AppNav from '../app-nav/app-nav';\r\n\r\nimport styles from './app-header.module.css';\r\n\r\nconst AppHeader = memo( () => (\r\n  <header className={ styles.header }>\r\n    <div className={ styles.container }>\r\n      <AppNav />\r\n      <div className={ styles.logo }>\r\n        <Logo />\r\n      </div>\r\n      <div className={ styles.login }>\r\n        <NavLink\r\n          to='/profile'\r\n          className='nav-link'\r\n        >\r\n          <ProfileIcon type='secondary' />\r\n          Личный кабинет\r\n        </NavLink>\r\n      </div>\r\n    </div>\r\n  </header>\r\n) );\r\n\r\nexport default AppHeader;\r\n","import React, { ReactNode } from 'react';\n\nimport AppHeader from '../app-header/app-header';\n\nconst Layout = ( { children }: {children: ReactNode } ) => {\n  return (\n    <>\n      <AppHeader />\n      <main className='pt-10'>\n        <div className='container pl-5 pr-5'>\n          { children }\n        </div>\n      </main>\n    </>\n  );\n};\n\nexport default Layout;\n","import { createAsyncThunk, createSlice, SerializedError } from '@reduxjs/toolkit';\n\nimport { addItem, removeItem, addBun } from './burger-constructor';\nimport { postOrder } from './posted-order-details';\n\nimport { IAsyncThunkExtraArgument, TIngredient } from '../../types';\n\ninterface IBurgerIngredientsState {\n  items: Array<TIngredient>;\n  loading: boolean;\n  error: SerializedError | null;\n}\n\nexport const initialState: IBurgerIngredientsState = {\n  items: [],\n  loading: false,\n  error: null,\n};\n\nconst fetchIngredients = createAsyncThunk <\n    Array<TIngredient>,\n    void,\n    IAsyncThunkExtraArgument\n  >\n  (\n  'burgerIngredients/fetchData',\n  async ( _, { extra } ) => {\n    const response = await extra.getIngredienst();\n    const json = await response.json();\n    return json.data;\n  }\n);\n\nconst burgerIngredientsSlice = createSlice( {\n  name: 'burgerIngredients',\n  initialState,\n  reducers: {},\n  extraReducers: ( builder ) => {\n    builder\n      .addCase( fetchIngredients.fulfilled, ( state, action ) => {\n        state.loading = false;\n        state.items = action.payload;\n      } )\n      .addCase( fetchIngredients.pending, ( state ) => {\n        state.loading = true;\n      } )\n      .addCase( fetchIngredients.rejected, ( state, action ) => {\n        state.loading = false;\n        state.error = action.error;\n        state.items = [];\n      } )\n      .addCase( addItem, ( state, { payload } ) => {\n        const ingredient = state.items.find( ( item ) => item._id === payload._id );\n\n        if ( ingredient ){\n          if ( ingredient.quantity ) {\n            ++ingredient.quantity;\n          } else {\n            ingredient.quantity = 1;\n          }\n        }\n      } )\n      .addCase( removeItem, ( state, { payload } ) => {\n        const item = state.items.find( ( item ) => item._id === payload );\n        item?.quantity && --item.quantity;\n      } )\n      .addCase( addBun, ( state, { payload: { bun, activeBun } } ) => {\n        if ( activeBun !== null ) {\n          const pastBun = state.items\n            .find( ( item ) => item._id === activeBun._id );\n          if ( pastBun !== undefined ) {\n           pastBun.quantity = 0;\n          }\n        }\n\n        const currentBun = state.items.find( ( item ) => item._id === bun._id );\n        if( currentBun ) currentBun.quantity = 1;\n      } )\n      .addCase( postOrder.fulfilled, ( state ) => {\n        state.items.forEach( ( ingredient ) => {\n          if ( ingredient.quantity ) {\n          ingredient.quantity = 0;\n        }} );\n      } );\n  },\n} );\n\nexport { fetchIngredients };\n\nexport default burgerIngredientsSlice.reducer;\n","import React, { useEffect, useCallback } from 'react';\nimport { useDispatch, useSelector } from '../../hooks';\nimport { Switch, Route, useLocation, useHistory } from 'react-router-dom';\nimport ProtectedRoute from '../protected-route/protected-route';\nimport { TLocationState } from '../../types';\n\nimport {\n  HomePage,\n  LoginPage,\n  FeedPage,\n  ForgotPasswordPage,\n  IngredientPage,\n  NotFound404,\n  ProfilePage,\n  RegistrationPage,\n  ResetPasswordPage\n} from '../../pages';\n\nimport Modal from '../modal/modal';\nimport IngredientDetails from '../ingredient-details/ingredient-details';\nimport OrderInfo from '../order-info/order-info';\n\nimport Layout from '../layout/layout';\n\nimport Error from '../error/error';\nimport Spinner from '../spinner/spinner';\n\nimport { fetchIngredients } from '../../store/slices/burger-ingredients';\n\nconst App = () => {\n  const location = useLocation<TLocationState>();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  console.log( location );\n\n  const isPoP = history.action === 'POP';\n  const ingredientLocation = !isPoP ? location.state?.ingredientLocation : null;\n  const orderLocation = !isPoP ? location.state?.orderLocation : null;\n\n  useEffect( () => {\n    dispatch( fetchIngredients() );\n  }, [dispatch] );\n\n  const closeModal = useCallback( () => {\n    history.goBack();\n  },[history] );\n\n  const { loading, error, items } = useSelector(\n    ( state ) => state.burgerIngredients\n  );\n\n  return (\n    <Layout>\n      { loading && ( <Spinner /> ) }\n      { error && ( <Error error={ error } /> ) }\n      { ( !loading && !error && !!items.length ) && (\n        <>\n          <Switch location={ ingredientLocation || orderLocation || location }>\n            <Route path='/' exact={ true } >\n              <HomePage/>\n            </Route>\n            <Route path='/ingredients/:id'>\n              <IngredientPage/>\n            </Route>\n            <Route path='/login'>\n              <LoginPage/>\n            </Route>\n            <Route path='/register'>\n              <RegistrationPage/>\n            </Route>\n            <Route path='/forgot-password'>\n              <ForgotPasswordPage/>\n            </Route>\n            <Route path='/reset-password'>\n              <ResetPasswordPage/>\n            </Route>\n            <Route path='/feed' exact={ true }>\n              <FeedPage/>\n            </Route>\n            <Route path={ ['/feed/:id', '/profile/orders/:id'] }>\n              <OrderInfo/>\n            </Route>\n            <ProtectedRoute path='/profile'>\n              <ProfilePage/>\n            </ProtectedRoute>\n            <Route>\n              <NotFound404/>\n            </Route>\n          </Switch>\n          { ingredientLocation && (\n            <Route path='/ingredients/:id' >\n              <Modal title='Детали ингредиента' onClose={ closeModal }>\n                <IngredientDetails/>\n              </Modal>\n            </Route>\n          ) }\n          { orderLocation && (\n            <Route path={ ['/feed/:id', '/profile/orders/:id'] } >\n              <Modal onClose={ closeModal }>\n                <OrderInfo/>\n              </Modal>\n            </Route>\n          ) }\n        </>\n      ) }\n    </Layout>\n  );\n};\n\nexport default App;\n","import { WS_ALL_ORDERS_URL, WS_USER_ORDERS_URL } from '../utils/constants';\nimport { getCookie } from '../utils/cookie';\n\nconst token = getCookie( 'token' )?.split( ' ' )[1];\n\ninterface IWsServices {\n  [k: string]: () => WebSocket\n}\n\nconst wsServices: IWsServices = {\n  allOrders: () => new WebSocket( WS_ALL_ORDERS_URL ),\n  userOrders: () => new WebSocket( `${ WS_USER_ORDERS_URL }?token=${ token }` )\n};\n\nexport default wsServices;\n","import { AnyAction, MiddlewareAPI } from '@reduxjs/toolkit';\nimport wsServices from '../../services/wsServices';\nimport wsActions from '../ws-actions/index';\n\nexport const socketMiddleware = () => {\n  return ( store: MiddlewareAPI ) => {\n    let socket: WebSocket | null = null;\n    let socketName = '';\n    return ( next: ( a: AnyAction ) => void ) => ( action: AnyAction ) => {\n      const { dispatch } = store;\n      const { type, payload } = action;\n      if ( type === wsActions.common.wsConnectionInit.toString() ) {\n        socketName = payload;\n        socket = wsServices[ payload ]();\n      }\n\n      if ( type === wsActions.common.wsConnectionClose.toString() ) {\n        socket && socket.close();\n      }\n\n      if ( socket ) {\n        socket.onopen = ( event ) => {\n          dispatch(  wsActions[socketName].onOpen( event.type ) );\n        };\n\n        socket.onmessage = ( event ) => {\n          const { data } = event;\n          const parsedData = JSON.parse( data );\n          dispatch(  wsActions[socketName].onMessage( parsedData ) );\n        };\n\n        socket.onerror = ( event ) => {\n          dispatch(  wsActions[socketName].onError( event.type ) );\n        };\n\n        socket.onclose = ( event ) => {\n          dispatch(  wsActions[socketName].onClose( event.type ) );\n        };\n      }\n      next( action );\n    };\n  };\n};\n\nexport default socketMiddleware;\n","import {\n  INGREDIENTS_ULR,\n  ORDERS_URL,\n  PASSWORD_RESET_URL,\n  REGISTER_URL,\n  LOGIN_URL,\n  TOKEN_REFRESH_URL,\n  LOGOUT_URL,\n  USER_DATA_URL\n} from '../utils/constants';\n\nimport { getCookie } from '../utils/cookie';\n\nimport { IApi, TUserData } from '../types';\n\nclass Api implements IApi{\n  private static _instance: Api;\n\n  public static instance() {\n    if ( !this._instance ) {\n      this._instance = new Api();\n    }\n    return this._instance;\n  }\n\n  getIngredienst = async () => await fetch(\n    String(\n      new URL( INGREDIENTS_ULR )\n    )\n  );\n\n  getOrderDetails = async ( ingredientsIds: Array<string> ) => {\n    const url: URL = new URL( ORDERS_URL );\n\n    return await fetch( String( url ), {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json',\n        'Authorization': String( getCookie( 'token' ) )\n      },\n      'body': JSON.stringify( { 'ingredients': ingredientsIds } )\n    } );\n  };\n\n  getOrderById = async ( id: string ) => {\n    const url = String( new URL( ORDERS_URL + '/' + id ) );\n\n    return await fetch( url, {\n      'method': 'GET',\n      'headers': {\n        'Content-Type': 'application/json'\n      }\n    } );\n  }\n\n  getUserData = async () => {\n    const url = String( new URL( USER_DATA_URL ) );\n\n    return await fetch( url, {\n      'method': 'GET',\n      'headers': {\n        'Content-Type': 'application/json',\n        'Authorization': String( getCookie( 'token' ) )\n      }\n    } );\n  }\n\n  setUserData = async ( userData: TUserData ) => {\n    const url = String( new URL( USER_DATA_URL ) );\n\n    return await fetch( url, {\n      'method': 'PATCH',\n      'headers': {\n        'Content-Type': 'application/json',\n        'authorization': String( getCookie( 'token' ) )\n      },\n      'body': JSON.stringify( userData )\n    } );\n  }\n\n  login = async ( userData: TUserData ) => {\n    const url = String( new URL( LOGIN_URL ) );\n\n    return await fetch( url, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      'body': JSON.stringify( userData )\n    } );\n  }\n\n  logout = async () => {\n    const url = String( new URL( LOGOUT_URL ) );\n\n    return await fetch( url, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json',\n      },\n      'body': JSON.stringify( { 'token': getCookie( 'refreshToken' ) } )\n    } );\n  }\n\n  register = async ( userData: TUserData ) => {\n    const url = String( new URL( REGISTER_URL ) );\n\n    return await fetch( url, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      'body': JSON.stringify( userData )\n    } );\n  }\n\n  checkEmailForPassReset = async ( email: string ) => {\n    const url = String( new URL( PASSWORD_RESET_URL ) );\n\n    return await fetch( url, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json',\n      },\n      'body': JSON.stringify( { email } )\n    } );\n  }\n\n  resetPassword = async ( userData: TUserData ) => {\n    const url =  String( new URL( PASSWORD_RESET_URL + '/reset' ) );\n\n    return await fetch( url, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      'body': JSON.stringify( userData )\n    } );\n  }\n\n  refreshToken = async () => {\n    const url =  String( new URL( TOKEN_REFRESH_URL ) );\n\n    return await fetch( url, {\n      'method': 'POST',\n      'headers': {\n        'Content-Type': 'application/json',\n        'authorization':  String( getCookie( 'refreshToken' ) )\n      },\n      'body': JSON.stringify( { 'token': getCookie( 'refreshToken' ) } )\n    } );\n  }\n};\n\nexport default Api.instance();\n","import burgerIngredientsReducer from './burger-ingredients';\nimport burgerConstructorReducer from './burger-constructor';\nimport postedOrderDetailsReducer from './posted-order-details';\nimport forgotPasswordReducer from './forgot-password';\nimport registrationPageReducer from './registration';\nimport loginReducer from './login';\nimport resetPasswordReducer from './reset-password';\nimport profileReducer from './profile';\nimport allOrdersFeedReducer from './all-orders-feed';\nimport userOrdersFeedReducer from './user-orders-feed';\nimport userOrderReducer from './user-order';\n\nconst rootReducer = {\n  burgerIngredients: burgerIngredientsReducer,\n  burgerConstructor: burgerConstructorReducer,\n  postedOrderDetails: postedOrderDetailsReducer,\n  forgotPassword: forgotPasswordReducer,\n  registration: registrationPageReducer,\n  login: loginReducer,\n  resetPassword: resetPasswordReducer,\n  profile: profileReducer,\n  allOrdersFeed: allOrdersFeedReducer,\n  userOrdersFeed: userOrdersFeedReducer,\n  userOrder: userOrderReducer\n};\n\nexport default rootReducer;\n","import { configureStore } from '@reduxjs/toolkit';\nimport ordersFeedSocketMiddleware from './middlewares/ordersFeedSocketMiddleware';\nimport Api from '../services/api';\n\nimport rootReducer from './slices/index';\n\nconst store = configureStore( {\n  reducer: rootReducer,\n  middleware: ( getDefaultMiddleware ) =>\n    getDefaultMiddleware( {\n      thunk: {\n        extraArgument: Api,\n      },\n    } )\n    .concat( ordersFeedSocketMiddleware() ),\n} );\n\nexport default store;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter as Router } from 'react-router-dom';\n\nimport './index.css';\nimport App from './components/app/app';\n\nimport store from './store/index';\n\nReactDOM.render(\n  <Provider store={ store }>\n    <React.StrictMode>\n      <Router>\n        <App />\n      </Router>\n    </React.StrictMode>\n  </Provider>,\n  document.getElementById( 'root' )\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"profile_wrapper__1Oz3z\",\"side-bar\":\"profile_side-bar__3srX8 pt-20\",\"nav\":\"profile_nav__1ddV4 mb-20\",\"list\":\"profile_list__2lI8E list-reset\",\"link\":\"profile_link__1-1p8 text_type_main-medium pt-4 pb-4\",\"description\":\"profile_description__2Qw7N text text_type_main-default\",\"main\":\"profile_main__qGy5r\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"burger-constructor_section__3LLkY pt-5 pr-2 pl-4\",\"ingredients\":\"burger-constructor_ingredients__3srro pb-10\",\"ingredientsData\":\"burger-constructor_ingredientsData__2dKUu pb-10 pt-10\",\"canDrop\":\"burger-constructor_canDrop__26IG6\",\"ingredientInflight\":\"burger-constructor_ingredientInflight__1rOAL\",\"list\":\"burger-constructor_list__2lXaw list-reset pr-2\",\"placeholder\":\"burger-constructor_placeholder__11mNA\",\"placeholder-text\":\"burger-constructor_placeholder-text__2PKTo text_type_main-default\",\"item\":\"burger-constructor_item__9YfeG\",\"helper\":\"burger-constructor_helper__Tg2qn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"order-card_card__38Dy5 p-6\",\"header\":\"order-card_header__3UVIG mb-6\",\"id\":\"order-card_id__xhHjl text_type_digits-default\",\"time\":\"order-card_time__W6OQi text_type_main-default\",\"title\":\"order-card_title__t4vNx text_type_main-medium text mb-2\",\"status\":\"order-card_status__3aQVL text text_type_main-default mb-6\",\"main\":\"order-card_main__29qfJ\",\"ingredients\":\"order-card_ingredients__20T5_ list-reset\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"spinner\":\"spinner_spinner__21x4r\",\"star\":\"spinner_star__1nZq7\",\"breath\":\"spinner_breath__1EDr1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"details\":\"order-details_details__2AXaS pb-30\",\"id\":\"order-details_id__1POxV text text_type_digits-large mb-8\",\"title\":\"order-details_title__FoYOr text text_type_main-medium mb-15\",\"status\":\"order-details_status__3_H80 text text_type_main-default mb-2\",\"note\":\"order-details_note__1kCj6 text text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"feed_title__yRxeu text text_type_main-large mb-5\",\"flex\":\"feed_flex__2OsPm\",\"column\":\"feed_column__1n4kj\",\"table-wrapper\":\"feed_table-wrapper__CtBJ9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"modal_modal__1DF1f pt-10 pr-10 pl-10\",\"header\":\"modal_header__2iX3r\",\"title\":\"modal_title__1efUU text text_type_main-large\",\"close-btn\":\"modal_close-btn__BlO8T btn-reset\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"form-page-template_wrapper__27bpt\",\"title\":\"form-page-template_title__kkI5w text text_type_main-medium mb-6\",\"error\":\"form-page-template_error__1JolC text text_type_main-medium mb-6\",\"form\":\"form-page-template_form__1fbzy pb-20\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"orders-feed_list__3GqEa list-reset pr-2\",\"item\":\"orders-feed_item__1-jJu mb-4\",\"link\":\"orders-feed_link__rU-ak\",\"text\":\"orders-feed_text__2eQFQ text text_type_main-medium\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"app-header_header__1iHLW pt-3 pb-3\",\"logo\":\"app-header_logo__zVEfY\",\"login\":\"app-header_login__3afH_\",\"container\":\"app-header_container__2ER_- container\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"error\":\"error_error__3hTfz\",\"text\":\"error_text__3r-RT text text_type_main-medium\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"burger-ingredients_section__JPGCZ\",\"list\":\"burger-ingredients_list__HZyi9 list-reset pl-4 pr-1\",\"item\":\"burger-ingredients_item__3x5fV mr-6 from global, mb-8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"text\":\"active-bun_text__2v0UU text text_type_main-default p-4 mb-4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"tabs-list_list__10Eas list-reset\",\"item\":\"tabs-list_item__1p4zc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"note\":\"note_note__39uPX text text_type_main-default\",\"link\":\"note_link__2bvUO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form\":\"user-form_form__3X2o9 pt-20\",\"flex\":\"user-form_flex__2jMB5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredient\":\"ingredient-preview_ingredient__2oK9u\",\"more\":\"ingredient-preview_more__3eso2 text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"ingredient-page_wrapper__3c4gt\",\"title\":\"ingredient-page_title__6A0MN text_type_main-large text\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"not-found-404_wrapper__2cvOE\",\"text\":\"not-found-404_text__3pGcU text text_type_main-large\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"app-nav_list__Zatwd list-reset\",\"item\":\"app-nav_item__3P1pn mr-2\"};"],"sourceRoot":""}